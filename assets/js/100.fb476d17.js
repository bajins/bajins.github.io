(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{454:function(a,t,s){"use strict";s.r(t);var e=s(0),r=Object(e.a)({},function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"windowsbatch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windowsbatch"}},[a._v("#")]),a._v(" WindowsBatch")]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#flag"}},[a._v("Flag")])]),t("li",[t("a",{attrs:{href:"#文件操作"}},[a._v("文件操作")]),t("ul",[t("li",[t("a",{attrs:{href:"#获取目录名"}},[a._v("获取目录名")])]),t("li",[t("a",{attrs:{href:"#获取为指定后缀的文件"}},[a._v("获取为指定后缀的文件")])]),t("li",[t("a",{attrs:{href:"#获取不为指定后缀的文件"}},[a._v("获取不为指定后缀的文件")])]),t("li",[t("a",{attrs:{href:"#判断是文件还是文件夹"}},[a._v("判断是文件还是文件夹")])]),t("li",[t("a",{attrs:{href:"#替换文件中指定内容"}},[a._v("替换文件中指定内容")])])])]),t("li",[t("a",{attrs:{href:"#环境变量"}},[a._v("环境变量")]),t("ul",[t("li",[t("a",{attrs:{href:"#查看环境变量"}},[a._v("查看环境变量")])]),t("li",[t("a",{attrs:{href:"#设置环境变量"}},[a._v("设置环境变量")])])])]),t("li",[t("a",{attrs:{href:"#ip端口dns进程"}},[a._v("IP端口DNS进程")]),t("ul",[t("li",[t("a",{attrs:{href:"#dns"}},[a._v("DNS")])]),t("li",[t("a",{attrs:{href:"#查看端口占用"}},[a._v("查看端口占用")])]),t("li",[t("a",{attrs:{href:"#查看占用的pid"}},[a._v("查看占用的pid")])]),t("li",[t("a",{attrs:{href:"#结束进程"}},[a._v("结束进程")])])])]),t("li",[t("a",{attrs:{href:"#延时定时事件任务"}},[a._v("延时定时事件任务")]),t("ul",[t("li",[t("a",{attrs:{href:"#任务计划"}},[a._v("任务计划")])]),t("li",[t("a",{attrs:{href:"#事件"}},[a._v("事件")])])])]),t("li",[t("a",{attrs:{href:"#判断字符串"}},[a._v("判断字符串")])]),t("li",[t("a",{attrs:{href:"#进制转换"}},[a._v("进制转换")])]),t("li",[t("a",{attrs:{href:"#管理员权限"}},[a._v("管理员权限")])]),t("li",[t("a",{attrs:{href:"#隐藏窗口运行"}},[a._v("隐藏窗口运行")])]),t("li",[t("a",{attrs:{href:"#刷新桌面"}},[a._v("刷新桌面")])]),t("li",[t("a",{attrs:{href:"#开机启动"}},[a._v("开机启动")]),t("ul",[t("li",[t("a",{attrs:{href:"#添加注册表"}},[a._v("添加注册表")])]),t("li",[t("a",{attrs:{href:"#启动目录"}},[a._v("启动目录")])])])]),t("li",[t("a",{attrs:{href:"#注册表"}},[a._v("注册表")]),t("ul",[t("li",[t("a",{attrs:{href:"#regini"}},[a._v("regini")])]),t("li",[t("a",{attrs:{href:"#修改"}},[a._v("修改")])]),t("li",[t("a",{attrs:{href:"#窗口设置"}},[a._v("窗口设置")])]),t("li",[t("a",{attrs:{href:"#查询"}},[a._v("查询")])])])]),t("li",[t("a",{attrs:{href:"#注册服务"}},[a._v("注册服务")]),t("ul",[t("li",[t("a",{attrs:{href:"#加入服务"}},[a._v("加入服务")])]),t("li",[t("a",{attrs:{href:"#删除服务"}},[a._v("删除服务")])])])]),t("li",[t("a",{attrs:{href:"#下载文件"}},[a._v("下载文件")])])])]),t("p"),a._v(" "),t("h2",{attrs:{id:"flag"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[a._v("#")]),a._v(" Flag")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/windows-commands",target:"_blank",rel:"noopener noreferrer"}},[a._v("Windows 命令-官方文档"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/kekec/p/3662125.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("windows常用命令"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/kekec/p/3937530.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("windows批处理语法"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://juejin.im/post/5d50c631518825378d5d6121",target:"_blank",rel:"noopener noreferrer"}},[a._v("windows之四十个bat脚本命令"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://segmentfault.com/a/1190000018614430",target:"_blank",rel:"noopener noreferrer"}},[a._v("windows bat脚本总结"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://www.thewindowsclub.com/rundll32-shortcut-commands-windows",target:"_blank",rel:"noopener noreferrer"}},[a._v("Windows 10/8/7的Rundll32命令列表"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://gitlab.com/jarv/cmdchallenge",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://gitlab.com/jarv/cmdchallenge"),t("OutboundLink")],1),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://cmdchallenge.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://cmdchallenge.com"),t("OutboundLink")],1)])])]),a._v(" "),t("li",[a._v("打包成exe "),t("a",{attrs:{href:"https://github.com/jeremyben/thebatchman",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/jeremyben/thebatchman"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/npocmaka/batch.scripts",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/npocmaka/batch.scripts"),t("OutboundLink")],1)])]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"/files/%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F.bat"}},[a._v("添加快捷方式")])]),a._v(" "),t("li",[t("a",{attrs:{href:"/files/%E8%AE%BE%E7%BD%AE%E5%BF%85%E5%BA%94%E5%A3%81%E7%BA%B8.bat"}},[a._v("设置必应壁纸")])]),a._v(" "),t("li",[t("a",{attrs:{href:"/files/%E8%AE%BE%E7%BD%AEgithub%E7%9A%84hosts.bat"}},[a._v("设置GitHub的Hosts")])]),a._v(" "),t("li",[t("a",{attrs:{href:"/files/frpc.bat"}},[a._v("frpc.bat")]),a._v(" 会自动检测本地"),t("code",[a._v("fprc")]),a._v("是否为最新版本，如果不是或者没有则下载最新版")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("if")]),a._v("和"),t("code",[a._v("for")]),a._v("的条件与后面跟的"),t("code",[a._v("(")]),a._v("之间必须要有一个空格，否则会出现"),t("code",[a._v("命令语法不正确")]),a._v("的问题！")]),a._v(" "),t("li",[a._v("使用cd切换目录时，如果带盘符一定要加"),t("code",[a._v("/d")]),a._v("参数，否则切换无效")]),a._v(" "),t("li",[a._v("双引号中包含双引号最里层的要用三个"),t("code",[a._v('"""')]),a._v("转义，"),t("code",[a._v("&")]),a._v("符号要用"),t("code",[a._v("^")]),a._v("转义\n"),t("ul",[t("li",[a._v("示例:使用"),t("code",[a._v("curl")]),a._v("配合"),t("code",[a._v("jq")]),a._v("获取必应壁纸下载地址")])])])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://cn.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("\n | jq-win64.exe "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('".images[0].url | """')]),a._v("https://cn.bing.com"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""" + .[0:index("""')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("&"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""")]"')]),a._v(" >> bing.txt")]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 解压MSI")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("msiexec")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"MSI文件路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/qn")]),a._v(" TARGETDIR="),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"解压输出目录绝对路径"')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 弹窗")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("msg")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%username%")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")])]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"WARNING:a backdoor account is created"')])]),a._v("\n")])])]),t("ul",[t("li",[a._v("Windows11当前桌面壁纸："),t("code",[a._v("%AppData%\\Microsoft\\Windows\\Themes\\TranscodedWallpaper")]),a._v(" 为转码文件")]),a._v(" "),t("li",[a._v("Windows10当前桌面壁纸："),t("code",[a._v("%AppData%\\Microsoft\\Windows\\Themes\\CachedFiles\\CachedImage_1920_1080_POS4.jpg")])]),a._v(" "),t("li",[a._v("Windows7当前桌面壁纸："),t("code",[a._v("%AppData%\\Microsoft\\Windows\\Themes\\TranscodedWallpaper.jpg")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Wallpapers")])]),a._v(" "),t("li",[t("code",[a._v("%AppData%\\Microsoft\\Windows\\Themes\\CachedFiles")])]),a._v(" "),t("li",[t("code",[a._v("%SystemRoot%\\Web")])]),a._v(" "),t("li",[t("code",[a._v("%SystemRoot%\\Resources\\Themes")])]),a._v(" "),t("li",[t("code",[a._v("%LocalAppData%\\Microsoft\\Windows\\Themes")])]),a._v(" "),t("li",[t("code",[a._v("HKEY_CURRENT_USER\\Control Panel\\Desktop\\WallPaper")])])])]),a._v(" "),t("li",[a._v("事件日志目录："),t("code",[a._v("%SystemRoot%\\System32\\Winevt\\Logs")])])]),a._v(" "),t("p",[t("strong",[a._v("获取用户名")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%username%")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("net")]),a._v(" user")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("whoami")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("query")]),a._v(" user")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("quser")])]),a._v("\n")])])]),t("h2",{attrs:{id:"文件操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件操作"}},[a._v("#")]),a._v(" 文件操作")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/robocopy",target:"_blank",rel:"noopener noreferrer"}},[a._v("robocopy复制文件及目录结构"),t("OutboundLink")],1)])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 路径都为文件所在顶级文件夹")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("robocopy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ndl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/njh")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/njs")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/s")]),a._v(" 源路径 目的路径 复制的文件多个以空格分隔")]),a._v("\n")])])]),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/xcopy",target:"_blank",rel:"noopener noreferrer"}},[a._v("xcopy复制文件及目录结构"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/forfiles",target:"_blank",rel:"noopener noreferrer"}},[a._v("forfiles遍历文件夹"),t("OutboundLink")],1)])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 列出文件，类似于linux下的ls")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("dir")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 创建目录")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("md")]),a._v(" 目录名（文件夹）")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 删除目录")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("rd")]),a._v("  目录名（文件夹）")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 拷贝文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("copy")]),a._v(" 路径\\文件名 路径\\文件名")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 移动文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("move")]),a._v(" 路径\\文件名 路径\\文件名")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 删除文件，不能删除文件夹")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("del")]),a._v(" 文件名")]),a._v("\n")])])]),t("h3",{attrs:{id:"获取目录名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取目录名"}},[a._v("#")]),a._v(" 获取目录名")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 顺序循环，设置最后一个为当前目录")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"delims="')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%cd%"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("folder")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~ni")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%folder%")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 仅将 %0 扩充到一个路径")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("currentPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 替换\\为,号，也可以替换为空格")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("currentPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%currentPath:")]),a._v("\\"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 顺序循环，设置最后一个为当前目录")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%currentPath%")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("folder")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%folder%")])]),a._v("\n")])])]),t("h3",{attrs:{id:"获取为指定后缀的文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取为指定后缀的文件"}},[a._v("#")]),a._v(" 获取为指定后缀的文件")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::获取为指定后缀的文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("*.jpg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("*.png"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t::把文件后缀赋值给变量\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" suffix "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~xa")])]),a._v("\n\t::把文件名赋值给变量（没有后缀）\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~na")])]),a._v("\n\t::把路径赋值给变量（不带驱动号和文件名）\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" path "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~pa")])]),a._v("\n\t::把驱动号赋值给变量\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" drive "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~da")])]),a._v("\n\t\n\t::判断后缀\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"!suffix!"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("neq")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('".bmp"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ren")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%%~a"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%%~na.bmp"')])]),a._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::获取为指定后缀的文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"delims="')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),a._v("dir "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/s")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" ^| findstr "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\.jpg\\> \\.png\\>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t::把文件后缀写入文件\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~dpnxi")]),a._v(" >> test.txt")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h3",{attrs:{id:"获取不为指定后缀的文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取不为指定后缀的文件"}},[a._v("#")]),a._v(" 获取不为指定后缀的文件")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::获取不为指定后缀的文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"delims="')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),a._v("dir "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/s")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" ^| findstr "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\.bat\\> \\.text\\> \\.exe\\>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t::把文件后缀写入文件\n\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~dpnxi")]),a._v(" >> test.txt")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h3",{attrs:{id:"判断是文件还是文件夹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#判断是文件还是文件夹"}},[a._v("#")]),a._v(" 判断是文件还是文件夹")]),a._v(" "),t("blockquote",[t("p",[a._v("如果是文件夹，则"),t("code",[a._v("test")]),a._v("和"),t("code",[a._v("test\\")]),a._v("、"),t("code",[a._v("test\\.")]),a._v("、"),t("code",[a._v("test\\nul")]),a._v("是等同的；\n如果是文件，则"),t("code",[a._v("test")]),a._v("不等同于三者中的任何一个")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exist")]),a._v(" test\\")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" test 是文件夹")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" test 是文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ad")]),a._v(" test >nul "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">nul ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" test 是文件夹")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" || "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" test 是文件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h3",{attrs:{id:"替换文件中指定内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#替换文件中指定内容"}},[a._v("#")]),a._v(" 替换文件中指定内容")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 解决把中文写入文件乱码问题（声明采用UTF-8编码），936为GBK，437为美国英语")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: https://blog.csdn.net/python_class/article/details/81560470")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("chcp")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("65001")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 开启延迟环境变量扩展")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 解决for或if中操作变量时提示ECHO OFF问题，用!!取变量")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 解决调用jscript提示命令错误问题")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("setlocal")]),a._v(" EnableDelayedExpansion")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0nav")]),a._v(".md")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 替换文件中指定内容")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tokens=*"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%file%")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n        :: 把当前行的内容赋值到变量\n        "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("s")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")])]),a._v("\n        :: 不为空行时\n        "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("not")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("!s!")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n            :: 替换内容中的反斜杠为正斜杠\n            "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("s")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("!s:\\=/!")])]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("!s!")])]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(">%file%\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":EXIT")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":EXIT")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 结束延迟环境变量扩展和命令执行")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("endlocal")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%errorlevel%")])]),a._v("\n")])])]),t("h2",{attrs:{id:"环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[a._v("#")]),a._v(" 环境变量")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/set_1",target:"_blank",rel:"noopener noreferrer"}},[a._v("set"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/setx",target:"_blank",rel:"noopener noreferrer"}},[a._v("setx"),t("OutboundLink")],1)])]),a._v(" "),t("p",[t("strong",[t("code",[a._v("SET")]),a._v("与"),t("code",[a._v("SETX")]),a._v("的区别")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("SET")]),a._v(" 用于设置临时环境变量和查看环境变量")]),a._v(" "),t("li",[t("code",[a._v("SETX")]),a._v(" 用于设置用户环境变量和系统环境变量")])]),a._v(" "),t("blockquote",[t("p",[a._v("变量值有空格或"),t("code",[a._v("%")]),a._v("等特殊字符时必须用"),t("code",[a._v('"')]),a._v("包括起来")])]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("SETX 变量名 变量值")]),a._v(" 设置用户环境变量，记录在注册表"),t("code",[a._v("HKEY_CURRENT_USER")])])]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("SETX /M 变量名 变量值")]),a._v(" 设置系统环境变量，记录在注册表"),t("code",[a._v("HKEY_LOCAL_MACHINE")])])]),a._v(" "),t("h3",{attrs:{id:"查看环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看环境变量"}},[a._v("#")]),a._v(" 查看环境变量")]),a._v(" "),t("ul",[t("li",[a._v("查看所有环境变量")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 在末尾输入变量名就是查询单个变量")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 或者这样查询单个环境变量")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%PATH%")])]),a._v("\n")])])]),t("ul",[t("li",[a._v("查看用户环境变量")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 替换最后的*号为变量名就是查询单个变量")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" QUERY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Environment"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" *")]),a._v("\n")])])]),t("ul",[t("li",[a._v("查看系统环境变量")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 替换最后的*号为变量名就是查询单个变量")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" QUERY "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" *")]),a._v("\n")])])]),t("h3",{attrs:{id:"设置环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置环境变量"}},[a._v("#")]),a._v(" 设置环境变量")]),a._v(" "),t("ul",[t("li",[a._v("临时有效")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%path%")]),a._v(";D:\\test")]),a._v("\n")])])]),t("ul",[t("li",[a._v("永久有效")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("setx")]),a._v(" path "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%path%;D:\\test"')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("setx")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/m")]),a._v(" path "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%path%;D:\\test"')])]),a._v("\n")])])]),t("h2",{attrs:{id:"ip端口dns进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ip端口dns进程"}},[a._v("#")]),a._v(" IP端口DNS进程")]),a._v(" "),t("p",[t("strong",[a._v("查看本机ip")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ipconfig")])]),a._v("\n")])])]),t("h3",{attrs:{id:"dns"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[a._v("#")]),a._v(" DNS")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("nslookup")]),a._v(" 域名")]),a._v("\n")])])]),t("p",[t("strong",[a._v("刷新DNS")])]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("C:\\Windows\\System32\\drivers\\etc\\hosts")])])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("netsh")]),a._v(" int ip reset")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("netsh")]),a._v(" int ipv6 reset")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("netsh")]),a._v(" winsock reset")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("netsh")]),a._v(" winhttp reset proxy")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ipconfig")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/release")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ipconfig")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/renew")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ipconfig")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/flushdns")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ipconfig")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/registerdns")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("inetcpl")]),a._v(".cpl")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ncpa")]),a._v(".cpl")]),a._v("\n")])])]),t("h3",{attrs:{id:"查看端口占用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看端口占用"}},[a._v("#")]),a._v(" 查看端口占用")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("netstat")]),a._v(" -an | find "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.0.0.0:80"')])]),a._v("\n")])])]),t("h3",{attrs:{id:"查看占用的pid"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看占用的pid"}},[a._v("#")]),a._v(" 查看占用的pid")]),a._v(" "),t("blockquote",[t("p",[a._v("在"),t("code",[a._v("windows")]),a._v("系统下，不能直接使用反引号执行命令，要使用"),t("code",[a._v("for")]),a._v("循环变通下，在"),t("code",[a._v("for")]),a._v("循环中使用单"),t("code",[a._v("'")]),a._v("括起来执行命令")])]),a._v(" "),t("blockquote",[t("p",[a._v("在"),t("code",[a._v("cmd")]),a._v("命令窗口中直接使用"),t("code",[a._v("for")]),a._v("循环只能使用单"),t("code",[a._v("%")]),a._v("设置变量")]),a._v(" "),t("p",[a._v("而在"),t("code",[a._v("bat")]),a._v("脚本文件中只能用双"),t("code",[a._v("%%")]),a._v("设置变量")]),a._v(" "),t("p",[a._v("而且在"),t("code",[a._v("for")]),a._v("循环中执行的命令带有"),t("code",[a._v("|")]),a._v("等特殊符号需要使用"),t("code",[a._v("^")]),a._v("转义")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 用findstr命令搜索")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),a._v("tasklist ^| findstr "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"程序名"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("reslut")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 只输出PID编号")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"skip=3 tokens=2"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),a._v("tasklist "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/fi")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"imagename eq 程序名*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%a")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("tasklist")]),a._v(" | findstr "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"java"')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("wmic")]),a._v(" process where "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"name like '%java%'\"")]),a._v(" get ProcessId,CommandLine")]),a._v("\n")])])]),t("p",[t("strong",[a._v("查看被占用端口的"),t("code",[a._v("pid")])])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("netstat")]),a._v(" -ano | findstr "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")])]),a._v("\n")])])]),t("h3",{attrs:{id:"结束进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#结束进程"}},[a._v("#")]),a._v(" 结束进程")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("taskkill")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/pid")]),a._v(" 进程号")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("taskkill")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/im")]),a._v(" 程序名")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("wmic")]),a._v(" process where "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ProcessId=pid"')]),a._v(" delete")]),a._v("\n")])])]),t("h2",{attrs:{id:"延时定时事件任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#延时定时事件任务"}},[a._v("#")]),a._v(" 延时定时事件任务")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 延时等待10秒")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("choice")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" y "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/n")]),a._v(" >nul")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 延时等待10秒")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/T")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/NOBREAK")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 持续等待，直到按下任意按键，类似于pause")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/T")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("-1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 持续等待，直到你按下CTRL+C按键")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/T")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("-1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/NOBREAK")])]),a._v("\n")])])]),t("h3",{attrs:{id:"任务计划"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#任务计划"}},[a._v("#")]),a._v(" 任务计划")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/daimaxuejia/p/12957644.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Schtasks命令详解"),t("OutboundLink")],1)])]),a._v(" "),t("p",[t("strong",[a._v("更高级用法见"),t("RouterLink",{attrs:{to:"/Shell/WindowsJScript.html#创建任务计划"}},[a._v("创建任务计划")])],1)]),a._v(" "),t("blockquote",[t("p",[a._v("如果任务计划运行没反应，去掉"),t("code",[a._v("/RU SYSTEM")]),a._v("试试")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("taskschd")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/?")]),a._v(" 查看帮助")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: /sc 指定计划频率：MINUTE、 HOURLY、DAILY、WEEKLY、MONTHLY, ONCE, ONSTART, ONLOGON, ONIDLE, ONEVENT")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"运行程序路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/sc")]),a._v(" DAILY")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 开机自启动")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"运行程序路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/sc")]),a._v(" ONSTART")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 每天 12:30 运行")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("schtasks")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"运行程序路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/sc")]),a._v(" DAILY "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/st")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 一分钟执行一次")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("schtasks")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"运行程序路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/sc")]),a._v(" MINUTE "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/mo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 在指定的开始日期和结束日期之间，每天 12:00 点开始到 14:00 点，每隔5分钟运行")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TR")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"运行程序路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/SD")]),a._v(" 开始日期 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ED")]),a._v(" 结束日期 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ST")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/SC")]),a._v(" MINUTE "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/MO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 每天 12:00 点开始到 14:00 点自动结束")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TR")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"运行程序路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ST")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ET")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/K")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/SC")]),a._v(" DAILY")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 将任务附加到事件上：登录成功事件，运行事件查看器")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TR")]),a._v(" eventvwr "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/SC")]),a._v(" ONEVENT "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/EC")]),a._v(" Security "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/MO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"*[System[Provider[@Name='Microsoft-Windows-Security-Auditing'] and EventID=4624]]\"")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 将任务附加到事件上：系统已从低功耗状态中恢复，运行事件查看器")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RU")]),a._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/RL")]),a._v(" Highest "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/tn")]),a._v(" 定时任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TR")]),a._v(" eventvwr "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/SC")]),a._v(" ONEVENT "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/EC")]),a._v(" System "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/MO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"*[System[Provider[@Name='Microsoft-Windows-Power-Troubleshooter'] and EventID=1]]\"")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 查询任务")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Query")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/fo")]),a._v(" LIST "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TN")]),a._v(" 任务名称")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 强制删除任务")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/Delete")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/F")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TN")]),a._v(" 任务名称")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 手动运行任务")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SCHTASKS")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/run")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/TN")]),a._v(" 任务名称")]),a._v("\n")])])]),t("h3",{attrs:{id:"事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事件"}},[a._v("#")]),a._v(" 事件")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("eventvwr")]),a._v(" 打开事件查看器\n"),t("ul",[t("li",[a._v("打开eventvwr -> Windows 日志 -> 系统 右键打开菜单 -> 将所有事件另存为(E) -> 选择保存类型为xml")])])]),a._v(" "),t("li",[t("code",[a._v("eventcreate")]),a._v(" 该命令行工具使管理员能够创建一个自定义事件 ID 和消息于某指定事件日志里。")]),a._v(" "),t("li",[t("code",[a._v("wmic ntevent /?")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("wmic ntevent list full")]),a._v(" 查看所有事件日志")])])]),a._v(" "),t("li",[t("code",[a._v("wmic nteventlog /?")])]),a._v(" "),t("li",[t("code",[a._v("wevtutil.exe qe Application /c:3 /rd:true /f:text")])]),a._v(" "),t("li",[t("code",[a._v("(get-winevent -listlog Application).providernames")]),a._v(" 或者 "),t("code",[a._v("wevtutil el")]),a._v(" 查看所有事件名")]),a._v(" "),t("li",[t("code",[a._v("计算机\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Publishers")]),a._v(" 注册表中所有事件")])]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("事件源")]),a._v(" "),t("th",[a._v("事件ID")]),a._v(" "),t("th",[a._v("说明")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("Power-Troubleshooter")]),a._v(" "),t("td",[a._v("1")]),a._v(" "),t("td",[a._v("系统已从低功耗状态中恢复。")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-Power")]),a._v(" "),t("td",[a._v("42")]),a._v(" "),t("td",[a._v("系统正在进入睡眠状态。")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-Power")]),a._v(" "),t("td",[a._v("105")]),a._v(" "),t("td",[a._v("电源更改。")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-Power")]),a._v(" "),t("td",[a._v("107")]),a._v(" "),t("td",[a._v("系统已从睡眠状态恢复。（已进入睡眠状态）")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-Power")]),a._v(" "),t("td",[a._v("130")]),a._v(" "),t("td",[a._v("系统开机恢复")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-Power")]),a._v(" "),t("td",[a._v("131")]),a._v(" "),t("td",[a._v("系统开机恢复")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-General")]),a._v(" "),t("td",[a._v("1")]),a._v(" "),t("td",[a._v("更改系统时间")])]),a._v(" "),t("tr",[t("td",[a._v("Kernel-General")]),a._v(" "),t("td",[a._v("24")]),a._v(" "),t("td",[a._v("已刷新时区信息，退出原因为 0。当前时区偏差为 -480。")])]),a._v(" "),t("tr",[t("td",[a._v("EventLog")]),a._v(" "),t("td",[a._v("6013")]),a._v(" "),t("td",[a._v("系统启动时间为 178611 秒。")])])])]),a._v(" "),t("h2",{attrs:{id:"判断字符串"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#判断字符串"}},[a._v("#")]),a._v(" 判断字符串")]),a._v(" "),t("blockquote",[t("p",[a._v("注意：在|两端不能有空格，如果有空格则会出现匹配不正确")]),a._v(" "),t("p",[a._v("这里有个BUG不能取反匹配，比如用"),t("code",[a._v("[^0-9]")]),a._v("匹配不是纯数字的字符，匹配到"),t("code",[a._v(".")]),a._v("会通过")])]),a._v(" "),t("p",[t("strong",[a._v("判断是否为数字、字母")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 判断是否为数字、字母，在|两端不能有空格")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 注意这里有个bug不能用[^0-9]取反，匹配到.会通过")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%var%")]),a._v("|findstr "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"^[a-z0-9]*$"')]),a._v(" >nul ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".输入的："),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%var%")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" || "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".输入的必须为纯小写字母或数字！")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("p",[t("strong",[a._v("判断是否为纯数字")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 判断是否为纯数字，在|两端不能有空格")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 注意这里有个bug不能用[^0-9]取反，匹配到.会通过")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%port%")]),a._v("|findstr "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"^[0-9]*$"')]),a._v(" >nul ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".输入的端口："),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%port%")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" || "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".端口必须为纯数字！")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ECHO")]),a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("p",[t("strong",[a._v("判断字符串是否包含子字符串")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 判断变量字符串中是否包含字符串")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" %字符串% | findstr %子串% >nul ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 包含")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" || "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不包含")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("error")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 判断文件中是否包含字符串")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("findstr")]),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/i")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".txt >nul "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">nul")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"error="')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("defined")]),a._v(" error")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不包含")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 包含")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h2",{attrs:{id:"进制转换"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进制转换"}},[a._v("#")]),a._v(" 进制转换")]),a._v(" "),t("ul",[t("li",[a._v("十进制转十六进制")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("setlocal")]),a._v(" enabledelayedexpansion")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/p")]),a._v(" 十进制"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("请输入要转换的十进制数：")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/l")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n     "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v(" 余"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("十进制"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("十进制"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("tmp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("余"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")])]),a._v("\n     "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("yu")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("!tmp:~1!")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("!yu!")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("yu")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%yu:00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v(" A B C D E F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n     "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("n")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("101")])]),a._v("\n     "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("!n:~-2!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n         "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("yu")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v("yu: "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%b")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")])]),a._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 0x"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%yu:")]),a._v(" =%")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("pause")])]),a._v("\n")])])]),t("ul",[t("li",[a._v("十六进制转十进制")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/p")]),a._v(" 十六进制"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("请输入十六进制数字：")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v(" 十进制"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("0x"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),a._v("十六进制:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("x")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" %十进制%")]),a._v("\n")])])]),t("h2",{attrs:{id:"管理员权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理员权限"}},[a._v("#")]),a._v(" 管理员权限")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("Windows10启用管理员：快捷键"),t("kbd",[a._v("Win")]),a._v(" + "),t("kbd",[a._v("r")]),a._v(" 打开“运行”输入"),t("code",[a._v("gpedit.msc")]),a._v("并运行 -> "),t("code",[a._v("Windows 设置")]),a._v(" -> "),t("code",[a._v("安全设置")]),a._v(" -> "),t("code",[a._v("安全选项")])]),a._v(" "),t("ul",[t("li",[a._v("禁用："),t("code",[a._v("用户账户控制：以管理员批准模式运行所有管理员")])]),a._v(" "),t("li",[a._v("禁用："),t("code",[a._v("用户账户控制：用于内置管理员账户的管理员批准模式")])]),a._v(" "),t("li",[a._v("启用："),t("code",[a._v("账户：管理员账户状态")])])])]),a._v(" "),t("li",[t("p",[a._v("判断")])])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("md")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0$testAdmin$"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">nul")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("not")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exist")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0$testAdmin$"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不具备所在目录的写入权限! >")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("2")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("rd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0$testAdmin$"')])]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 检查权限")]),a._v("\n>nul 2>"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SYSTEMROOT%\\system32\\cacls.exe"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SYSTEMROOT%\\system32\\config\\system"')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 如果没有管理员权限，就请求管理权限")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" '%"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("errorlevel")]),a._v("%' "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NEQ")]),a._v(" '"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不具备所在目录的写入权限! >")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("2")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 检查权限")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("net")]),a._v(" session >nul "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("1")]),a._v(" ")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" not "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%errorLevel%"')]),a._v(" == "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0"')]),a._v(" ( ")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不具备所在目录的写入权限! >")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("2")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("reg")]),a._v(" query HKU\\S"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("-1")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("-5")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("-20")]),a._v(">nul "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">nul")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" not "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%errorLevel%"')]),a._v(" == "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0"')]),a._v(" ( ")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不具备所在目录的写入权限! >")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("2")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("p",[t("strong",[a._v("获取管理员权限")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fltmc")]),a._v(">nul||cd"),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mshta")]),a._v(" vbscript:CreateObject("),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Shell.Application"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".ShellExecute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"%~nx0","%1","","runas",0'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("window")]),a._v(".close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::-------------------------------------------------------------------------------")]),a._v("\n>nul 2>"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SYSTEMROOT%\\system32\\cacls.exe"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SYSTEMROOT%\\system32\\config\\system"')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" '%"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("errorlevel")]),a._v("%' "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NEQ")]),a._v(" '"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" UACPrompt ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" GetAdmin ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":UACPrompt")]),a._v('\n    ::if not "%~1"=="" set file= ""%~1""\n    ::echo CreateObject'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"Shell.Application"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v('.ShellExecute "cmd.exe", "/c %~s0%file%", "", "runas", 0 > "%temp%\\getadmin.vbs"\n    '),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" CreateObject"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("("),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Shell.Application"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(").ShellExecute "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~s0"')]),a._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%*"')]),a._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"runas"')]),a._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" > "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')]),a._v(" ")]),a._v('\n    "%temp%\\getadmin.vbs"\n    '),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":GetAdmin")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exist")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("del")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')]),a._v(" ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("pushd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%CD%"')])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CD")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/D")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0"')])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":StartCommand")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::-------------------------------------------------------------------------------")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),t("h2",{attrs:{id:"隐藏窗口运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#隐藏窗口运行"}},[a._v("#")]),a._v(" 隐藏窗口运行")]),a._v(" "),t("p",[t("strong",[a._v("此方式完全不会显示"),t("code",[a._v("CMD")]),a._v("窗口（包括闪现） "),t("RouterLink",{attrs:{to:"/Shell/WindowsScript.html#vbs函数封装"}},[a._v("vbs脚本")])],1)]),a._v(" "),t("p",[t("strong",[a._v("此方式会闪现"),t("code",[a._v("CMD")]),a._v("窗口 bat脚本")])]),a._v(" "),t("blockquote",[t("p",[a._v("如果运行的批处理名为"),t("code",[a._v("a.bat")]),a._v("，在"),t("code",[a._v("C:\\")]),a._v("下，那"),t("code",[a._v("%~0")]),a._v("代表"),t("code",[a._v("C:\\a.bat")]),a._v("，"),t("code",[a._v("%~nx0")]),a._v("代表"),t("code",[a._v("a.bat")]),a._v("。"),t("code",[a._v("h")]),a._v("极为参数"),t("code",[a._v("%1")]),a._v("，"),t("code",[a._v("0")]),a._v("表示隐藏运行。")]),a._v(" "),t("p",[a._v("由于你双击运行，故第一次批处理"),t("code",[a._v("%1")]),a._v("为空，"),t("code",[a._v("if")]),a._v("不成立，转而运行下一句。\n然后再次打开自己，并传递参数"),t("code",[a._v("h")]),a._v("，此时"),t("code",[a._v("if")]),a._v("成立，跳转至"),t("code",[a._v("begin")]),a._v("开始运行。")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%1"')]),a._v(" == "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"h"')]),a._v(" goto begin")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mshta")]),a._v(" vbscript:createobject("),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"wscript.shell"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".run"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"%~0 h",0'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("window")]),a._v(".close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::mshta \"javascript:new ActiveXObject('WScript.Shell').Run('%~0 h',0);window.close()\"&&exit")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":begin")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 静默运行软件")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Pushd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/wait")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0软件名称"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/S")])]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 添加开机静默启动")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Pushd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/wait")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0软件名称"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ADD")])]),a._v("\n")])])]),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 删除开机静默启动")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Pushd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/wait")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0软件名称"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/DEL")])]),a._v("\n")])])]),t("h2",{attrs:{id:"刷新桌面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#刷新桌面"}},[a._v("#")]),a._v(" 刷新桌面")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("REM taskkill 用户窗口被关闭")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("taskkill")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/im")]),a._v(" explorer.exe >nul "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">nul")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" explorer.exe")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("REM regsvr32.exe 图标有白块")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("regsvr32")]),a._v(".exe "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/s")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/n")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")])]),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/UserInstall")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%SystemRoot%")]),a._v("\\system32\\themeui.dll")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 效果不太好，有时刷新成功，有时失败")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RunDll32")]),a._v(" USER32,UpdatePerUserSystemParameters")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: assoc文件关联有多余添加，可能报错，exe 类型几乎不会被修改成其他类型")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("assoc")]),a._v(" exe=exefile")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: .=. 应该比较保险")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("assoc")]),a._v(" .=.")]),a._v("\n")])])]),t("ul",[t("li",[a._v("刷新桌面图标")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("REM inf 代码太多")]),a._v("\n>%tmp%\\tmp.inf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(";[Version]")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(";Signature=$Chicago$")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(";[DefaultInstall]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("rundll32")]),a._v(" SETUPAPI.DLL,InstallHinfSection DefaultInstall "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("128")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%tmp%")]),a._v("\\tmp.inf")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("REM inf 需要%1是有效inf，win7报错：您选中INF文件不支持此安装方法")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('REM %SystemRoot%\\System32\\InfDefaultInstall.exe "%1"')]),a._v("\n")])])]),t("h2",{attrs:{id:"开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开机启动"}},[a._v("#")]),a._v(" 开机启动")]),a._v(" "),t("blockquote",[t("p",[a._v("有几种方法：注册表启动项、启动文件夹、服务(Services)、任务计划程序(Task Scheduler)")])]),a._v(" "),t("h3",{attrs:{id:"添加注册表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加注册表"}},[a._v("#")]),a._v(" 添加注册表")]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("Run")]),a._v("键值代表着开机启动项，也就是说在这个项下的键值会随着开机启动\n（这里的开机是指用户登录，也就是说只要有登录操作就会执行，注销然后登录，也会执行这个键值）。")])]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("RunOnce")]),a._v("键值类似于"),t("code",[a._v("Run")]),a._v("键值，唯一的区别在于，"),t("code",[a._v("RunOnce")]),a._v("键值只执行一次，操作执行后会被自动删除。")])]),a._v(" "),t("ul",[t("li",[a._v("用户启动项")])]),a._v(" "),t("ol",[t("li",[t("code",[a._v("HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run")])]),a._v(" "),t("li",[t("code",[a._v("HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce")])])]),a._v(" "),t("ul",[t("li",[a._v("本机启动项")])]),a._v(" "),t("ol",[t("li",[t("code",[a._v("HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager")])]),a._v(" "),t("li",[t("code",[a._v("HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run")])]),a._v(" "),t("li",[t("code",[a._v("HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce")])]),a._v(" "),t("li",[t("code",[a._v("HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run")])]),a._v(" "),t("li",[t("code",[a._v("HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce")])])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" 软件名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" 软件路径 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(':: 或者，%号和"号不能使用转移字符^转义，%号转义%%，"号转义"""')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" 软件名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""""')]),a._v("软件路径"),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""" /background"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n")])])]),t("h3",{attrs:{id:"启动目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动目录"}},[a._v("#")]),a._v(" 启动目录")]),a._v(" "),t("blockquote",[t("p",[a._v("把软件的快捷方式或者软件直接放在以下目录中就会开机自动运行")])]),a._v(" "),t("blockquote",[t("p",[a._v("可利用"),t("a",{attrs:{href:"/files/%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F.bat"}},[a._v("脚本添加快捷方式")]),a._v("直接在启动文件夹中生成快捷方式")])]),a._v(" "),t("blockquote",[t("p",[a._v("按"),t("code",[a._v("win+r")]),a._v("打开运行窗口，输入"),t("code",[a._v("shell:startup")]),a._v("打开启动文件夹，把快捷方式或者软件放入")])]),a._v(" "),t("ul",[t("li",[a._v("Win7及以上（当前用户）: "),t("code",[a._v("%AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup")])]),a._v(" "),t("li",[a._v("启动目录（所有用户）: "),t("code",[a._v("%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp")])])]),a._v(" "),t("h2",{attrs:{id:"注册表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注册表"}},[a._v("#")]),a._v(" 注册表")]),a._v(" "),t("blockquote",[t("p",[a._v("注册表被称为Windows操作系统的核心，它的工作原理实质是一个庞大的数据库，存放了关于计算机硬件的配置信息、\n系统和应用软件的初始化信息、应用软件和文档文件的关联关系、硬件设备的说明以及各种状态信息和数据，包括Windows操作时不断引用的信息。")])]),a._v(" "),t("blockquote",[t("p",[a._v("例如：系统中的硬件资源、硬件信息、分配正在使用的端口、每个用户的配置文件、计算机上安装的应用程序以及每个应用程序可以创建的文件类型等。")])]),a._v(" "),t("blockquote",[t("p",[a._v("组策略设置的实质是修改注册表中的配置")])]),a._v(" "),t("p",[t("strong",[a._v("主要作用")])]),a._v(" "),t("ol",[t("li",[a._v("记录安装信息")]),a._v(" "),t("li",[a._v("设置硬件")]),a._v(" "),t("li",[a._v("设置软件")]),a._v(" "),t("li",[a._v("定制Windows")]),a._v(" "),t("li",[a._v("系统安全管理")]),a._v(" "),t("li",[a._v("自动运行程序")]),a._v(" "),t("li",[a._v("网络设置")])]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/72194354",target:"_blank",rel:"noopener noreferrer"}},[a._v("Windows注册表内容详解"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://segmentfault.com/a/1190000016854021",target:"_blank",rel:"noopener noreferrer"}},[a._v("简析Windows注册表"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/weiyinfu/p/10961872.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("windows注册表"),t("OutboundLink")],1)])]),a._v(" "),t("p",[t("strong",[a._v("注册表的分支结构")])]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("注册表短根键名")]),a._v(" "),t("th",[a._v("注册表长根键名")]),a._v(" "),t("th",[a._v("作用")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("HKCU")]),a._v(" "),t("td",[a._v("HKEY_CURRENT_USER")]),a._v(" "),t("td",[a._v("存储当前用户设置的信息。当前用户登录后才执行的操作")])]),a._v(" "),t("tr",[t("td",[a._v("HKLM")]),a._v(" "),t("td",[a._v("HKEY_LOCAL_MACHINE")]),a._v(" "),t("td",[a._v("包括安装在计算机上的硬件和软件的信息。所有操作在用户登录前就执行了")])]),a._v(" "),t("tr",[t("td",[a._v("HKCR")]),a._v(" "),t("td",[a._v("HKEY_CLASSES_ROOT")]),a._v(" "),t("td",[a._v("存储Windows可识别的文件类型的详细列表，以及相关联的程序。")])]),a._v(" "),t("tr",[t("td",[a._v("HKEY_USERS")]),a._v(" "),t("td",[a._v("HKEY_USERS")]),a._v(" "),t("td",[a._v("包含使用计算机的用户的信息。")])]),a._v(" "),t("tr",[t("td",[a._v("HKEY_CURRENT_CONFIG")]),a._v(" "),t("td",[a._v("HKEY_CURRENT_CONFIG")]),a._v(" "),t("td",[a._v("这个分支包含计算机当前的硬件配置信息。")])])])]),a._v(" "),t("p",[t("strong",[a._v("系统默认注册表位置")])]),a._v(" "),t("ul",[t("li",[a._v("为所有用户安装的程序："),t("code",[a._v("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall")])]),a._v(" "),t("li",[a._v("为当前用户安装的程序："),t("code",[a._v("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall")])]),a._v(" "),t("li",[a._v("64位系统中的32位程序："),t("code",[a._v("HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall")])])]),a._v(" "),t("blockquote",[t("p",[a._v("这3个注册表总有一个包含你要找的程序，不包括UWP应用。")])]),a._v(" "),t("blockquote",[t("p",[a._v("隐藏指定的程序：在右边空白处（或左边的项名称）点击右键->新建->DWORD（32位）值，命名为"),t("code",[a._v("SystemComponent")]),a._v("，\n并修改数据为"),t("code",[a._v("1")]),a._v("（新建后双击名称或右键点击选择修改，默认为"),t("code",[a._v("0")]),a._v("）。")])]),a._v(" "),t("blockquote",[t("p",[a._v('如果注册表项下面有"SystemComponent"字段并且值等于'),t("code",[a._v("1")]),a._v("时，表示这是个系统组件，而不是应用软件。")])]),a._v(" "),t("blockquote",[t("p",[a._v('如果注册表项下面有"ParentKeyName"字段则表示该项是某个分类下的子项，一般情况补丁才会有"ParentKeyName"字段。')])]),a._v(" "),t("h3",{attrs:{id:"regini"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#regini"}},[a._v("#")]),a._v(" regini")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/regini",target:"_blank",rel:"noopener noreferrer"}},[a._v("regini和其他所有命令官方文档"),t("OutboundLink")],1)])]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("权限")]),a._v(" "),t("th",[a._v("说明")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("1")]),a._v(" "),t("td",[a._v("Administrators 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("2")]),a._v(" "),t("td",[a._v("Administrators 只读访问")])]),a._v(" "),t("tr",[t("td",[a._v("3")]),a._v(" "),t("td",[a._v("Administrators 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("4")]),a._v(" "),t("td",[a._v("Administrators 读、写入、删除访问")])]),a._v(" "),t("tr",[t("td",[a._v("5")]),a._v(" "),t("td",[a._v("Creator 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("6")]),a._v(" "),t("td",[a._v("Creator 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("7")]),a._v(" "),t("td",[a._v("everyone 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("8")]),a._v(" "),t("td",[a._v("everyone 只读访问")])]),a._v(" "),t("tr",[t("td",[a._v("9")]),a._v(" "),t("td",[a._v("everyone 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("10")]),a._v(" "),t("td",[a._v("everyone 读、写入、删除访问")])]),a._v(" "),t("tr",[t("td",[a._v("11")]),a._v(" "),t("td",[a._v("Power Users 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("12")]),a._v(" "),t("td",[a._v("Power Users 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("13")]),a._v(" "),t("td",[a._v("Power Users 读、写入、删除访问")])]),a._v(" "),t("tr",[t("td",[a._v("14")]),a._v(" "),t("td",[a._v("System Operators 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("15")]),a._v(" "),t("td",[a._v("System Operators 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("16")]),a._v(" "),t("td",[a._v("System Operators 读、写入、删除访问")])]),a._v(" "),t("tr",[t("td",[a._v("17")]),a._v(" "),t("td",[a._v("System 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("18")]),a._v(" "),t("td",[a._v("System 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("19")]),a._v(" "),t("td",[a._v("System 只读访问")])]),a._v(" "),t("tr",[t("td",[a._v("20")]),a._v(" "),t("td",[a._v("Administrators 读、写、执行访问")])]),a._v(" "),t("tr",[t("td",[a._v("21")]),a._v(" "),t("td",[a._v("Interactive User 完全访问")])]),a._v(" "),t("tr",[t("td",[a._v("22")]),a._v(" "),t("td",[a._v("Interactive User 读和写入访问")])]),a._v(" "),t("tr",[t("td",[a._v("23")]),a._v(" "),t("td",[a._v("Interactive User 读、写入、删除访问")])])])]),a._v(" "),t("h3",{attrs:{id:"修改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改"}},[a._v("#")]),a._v(" 修改")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("/v")]),a._v(" 设置键名(value)")]),a._v(" "),t("li",[t("code",[a._v("/t")]),a._v(" 设置数据类型(type)")]),a._v(" "),t("li",[t("code",[a._v("/d")]),a._v(" 设置添加的值(data)")]),a._v(" "),t("li",[t("code",[a._v("/f")]),a._v(" 表示强制(forbidden)")])]),a._v(" "),t("ul",[t("li",[a._v("删除桌面IE图标")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" DELETE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\{B416D21B-3B22-B6D4-BBD3-BBD452DB3D5B}"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n")])])]),t("ul",[t("li",[a._v("修改开机时小数字键盘不开启的问题")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKU\\.DEFAULT\\Control Panel\\Keyboard"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" InitialKeyboardIndicators "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_SZ "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n")])])]),t("ul",[t("li",[a._v("把图片设置为壁纸")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Control Panel\\Desktop"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" TileWallpaper "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" ")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Control Panel\\Desktop"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" Wallpaper "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"图片绝对路径"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Control Panel\\Desktop"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" WallpaperStyle "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_DWORD "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RunDll32")]),a._v(".exe USER32.DLL,UpdatePerUserSystemParameters")]),a._v("\n")])])]),t("ul",[t("li",[a._v("开机自动运行")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" 自定义命名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n")])])]),t("ul",[t("li",[a._v("Windows Defender")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 关闭“启用Windows安全中心服务”的通知")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" DELETE "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellServiceObjects\\{F56F6FDD-AA9D-4618-A949-C1B91AF43B1A}"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 关闭Windows Defender")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"DisableAntiSpyware"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_DWORD "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 启用Windows Defender")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"DisableAntiSpyware"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_DWORD "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v("   ")]),a._v("\n")])])]),t("h3",{attrs:{id:"窗口设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#窗口设置"}},[a._v("#")]),a._v(" 窗口设置")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Mode")]),a._v(" con cols=宽分辨率 lines=高分辨率")]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("窗口大小是被改成了你想要的, 可是屏幕缓冲区的大小也变成了一样，这让你无法追溯屏幕打印的历史，\n也就是说"),t("code",[a._v("mode")]),a._v("对于窗口大小和屏幕缓冲区大小不能单独设置。")])]),a._v(" "),t("blockquote",[t("p",[a._v("解决办法就是修改注册表，先要知道保存系统默认的"),t("code",[a._v("cmd")]),a._v("命令窗口的屏幕缓冲区大小的两个键值")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 窗口大小")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("HKEY_CURRENT_USER")]),a._v("\\Console\\ScreenBufferSize")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 屏幕缓冲区大小")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("HKEY_CURRENT_USER")]),a._v("\\Console\\WindowSize")]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("值是用的十六进制值来表示的，十六进制可以前加零来补齐为8位来理解")]),a._v(" "),t("p",[a._v("十六进制的前四位是高，后四位是宽")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 窗口高宽40*120")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKEY_CURRENT_USER\\Console"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_DWORD "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" WindowSize "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" 0x00280078 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 屏幕缓冲区高宽1000*120")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKEY_CURRENT_USER\\Console"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_DWORD "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" ScreenBufferSize "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" 0x03e80078 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n")])])]),t("h3",{attrs:{id:"查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[a._v("#")]),a._v(" 查询")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("FOR /F "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"usebackq delims=="')]),a._v(" %i IN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("REG QUERY HKCU /v onedrive /s"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DO @echo %i\n")])])]),t("h2",{attrs:{id:"注册服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注册服务"}},[a._v("#")]),a._v(" 注册服务")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/pingming/p/5108947.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.cnblogs.com/pingming/p/5108947.html"),t("OutboundLink")],1)])]),a._v(" "),t("h3",{attrs:{id:"加入服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#加入服务"}},[a._v("#")]),a._v(" 加入服务")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 等号后面的空格必须")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" create 服务名称 binPath= 执行程序路径或者命令 start= auto displayname= "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"描述"')])]),a._v("\n")])])]),t("ul",[t("li",[a._v("示例")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" create frp内网穿透 binPath= D:\\frp\\frps.bat start= auto displayname= "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"frp内网穿透"')])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" create frp内网穿透 binPath= "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cmd.exe /c D:\\frp内网穿透工具\\frpc.exe -c D:\\frp内网穿透工具\\frpc.ini"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("\n start= auto displayname= "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"frp内网穿透"')])]),a._v("\n")])])]),t("h3",{attrs:{id:"删除服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除服务"}},[a._v("#")]),a._v(" 删除服务")]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" delete 服务名称")]),a._v("\n")])])]),t("h2",{attrs:{id:"下载文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载文件"}},[a._v("#")]),a._v(" 下载文件")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("certutil")])])]),a._v(" "),t("blockquote",[t("p",[a._v("用户备份证书服务管理，每次下载都会有缓存，缓存目录："),t("code",[a._v("%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content")])])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("certutil")]),a._v(" -urlcache -split "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("-f")]),a._v(" https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\\Windows\\bcn.bat")]),a._v("\n")])])]),t("ul",[t("li",[t("code",[a._v("bitsadmin")])])]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("bitsadmin.exe")]),a._v(" 是"),t("code",[a._v("windows")]),a._v("后台智能传输服务的一个工具，"),t("code",[a._v("windows")]),a._v("的自动更新，补丁之类的下载就是用这个工具来实现的。")])]),a._v(" "),t("div",{staticClass:"language-batch extra-class"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: /priority normal进度条等信息")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bitsadmin")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/transfer")]),a._v(" 任务名 "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/download")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/priority")]),a._v(" normal https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\\Windows\\bcn.bat")]),a._v("\n")])])])])},[],!1,null,null,null);t.default=r.exports}}]);