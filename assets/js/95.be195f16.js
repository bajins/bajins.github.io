(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{444:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"powershell命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#powershell命令"}},[t._v("#")]),t._v(" PowerShell命令")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),s("li",[s("a",{attrs:{href:"#基础命令"}},[t._v("基础命令")]),s("ul",[s("li",[s("a",{attrs:{href:"#事件计划任务"}},[t._v("事件计划任务")])])])]),s("li",[s("a",{attrs:{href:"#常用命令"}},[t._v("常用命令")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"flag"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.yiibai.com/powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.yiibai.com/powershell"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.pstips.net/tag/%e6%b3%a8%e5%86%8c%e8%a1%a8",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell注册表"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/scripting/samples/working-with-registry-entries",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用注册表条目"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/3963100/how-do-you-do-a-pause-with-powershell-2-0",target:"_blank",rel:"noopener noreferrer"}},[t._v("控制台暂停"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"基础命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础命令"}},[t._v("#")]),t._v(" 基础命令")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("ASCII")]),t._v(" 为无BOM"),s("code",[t._v("UTF-8")]),t._v("编码")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出所有的环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" env:\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Format-Table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Property Name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Value\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v(" env:\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" env:\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取环境变量的值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gi")]),t._v(" env:path\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Path"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(":变量名\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),t._v(" env:变量名\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(":变量名="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量值"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USER*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .NET方法操作可以全局生效")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改当前用户的环境变量（永久），只对新进程有效")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::SetEnvironmentvariable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"值"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[EnvironmentVariableTarget]")]),t._v("::User"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置系统环境变量（永久），只对新进程有效，需要管理员权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::SetEnvironmentvariable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"值"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[EnvironmentVariableTarget]")]),t._v("::Machine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# target 也可用字符串指定")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::SetEnvironmentvariable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"值"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::GetEnvironmentvariable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看输出的命令集")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Command")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("verb out\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Export-Csv")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Export-CliXML")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-file")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-GridView")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 独立弹窗")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ConvertTo-HTML")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-file")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write-Output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("out-host")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看属性")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Member")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MemberType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("property\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ExpandProperty Property\n")])])]),s("ul",[s("li",[t._v("查看版本")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看Power Shell版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PSVersionTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSVersion\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Major\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看当前PowerShell的.Net运行版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PSVersionTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CLRVersion\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有安装的.Net 版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HKLM:\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort-object")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Descending "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ExpandProperty PSChildName\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看安装的.Net 客户端版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ItemProperty")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HKLM:\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\\Client'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name Version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Version\n")])])]),s("ul",[s("li",[t._v("为本账户启用执行脚本策略")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set-ExecutionPolicy")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ExecutionPolicy RemoteSigned "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Scope CurrentUser\n")])])]),s("div",{staticClass:"language-ps1 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms\n# https://docs.microsoft.com/zh-tw/dotnet/api/microsoft.win32\n# https://docs.microsoft.com/zh-cn/dotnet/api/microsoft.visualbasic\n# 加载引用程序集\n[void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');\n$null = [System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');\n[System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms')  | Out-Null; # 最慢\nAdd-Type -assembly \"System.Windows.Forms\"\nAdd-Type -AssemblyName System.Windows.Forms\n\n[void][System.Windows.Forms.MessageBox]::Show(\"弹窗\");\n")])])]),s("ul",[s("li",[t._v("下载代码并通过"),s("code",[t._v("Invoke-Expression")]),t._v("执行")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Invoke-Expression")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Object")]),t._v(" System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Net"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DownloadString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://get.scoop.sh'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("下载文件")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Object")]),t._v(" System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Net"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DownloadFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://git.io/JvYAg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'d:\\\\7za.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("实现"),s("code",[t._v("du -sh")]),t._v("统计文件夹大小")])]),t._v(" "),s("div",{staticClass:"language-ps1 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('param([string]$Directory) \nget-childitem $Directory | % {\n    $f = $_ ; \n    get-childitem -r $_.FullName | \n      measure-object -property length -sum | \t\t\t\n        select @{Name="Name";Expression={$f}},\n        @{Name="Sum (MB)"; Expression={"{0:N1}" -f ($_.sum / 1MB)}}\n}\n')])])]),s("ul",[s("li",[t._v("循环目录")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取子目录和文件并遍历")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ForEach-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$project_name")]),t._v(" = "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果为子目录")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.DirectoryInfo]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换到子目录")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set-location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FullName\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 判断目录是否存在")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Test-Path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("git"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            git remote "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write-Host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PadLeft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("15"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始更新 '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$project_name")]),t._v(' "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PadRight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("30"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            git pull\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set-Location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("创建硬软连接")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 软连接SymbolicLink：支持跨分区，支持文件和目录，支持相对路径，支持跨文件系统")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 硬链接HardLink：不可跨分区，盘符修改不影响，不能为文件夹创建硬链接")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ItemType SymbolicLink `\n         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path C:\\ `\n         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name hosts `\n         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Target "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Windows\\System32\\drivers\\etc\\hosts"')]),t._v("\n")])])]),s("ul",[s("li",[t._v("创建文件夹")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ItemType directory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 目录的路径\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只列出目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.DirectoryInfo]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Attributes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.FileAttributes.Directory]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Attributes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-match")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Directory'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Substring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只列出文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.FileInfo]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("$false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Substring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-ne")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过管道过滤2020年5月12日后更改过的文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-gt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[datetime]")]),t._v("::Parse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"May 12, 2020"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取2周以内更改过的文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-gt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddDays"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("14"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("重命名")])]),t._v(" "),s("div",{staticClass:"language-ps1 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ls -Recurse -File -Include *.war,*.jar | ForEach-Object { Rename-Item -Path $_.fullname -newname ('test_' + $_.name)}\nls -Recurse -File -Include *.war,*.jar | ForEach-Object { Rename-Item -Path $_.fullname -newname ($_.name -replace 'test_','')}\nls -Recurse -File -Include *.war,*.jar | ForEach-Object -Begin {$count = 1}  -Process{`\n Rename-Item -Path $_.fullname -newname \"$_.basename$count$_.Extension\";$count++}\n")])])]),s("ul",[s("li",[t._v("复制文件及目录结构")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 源路径最后一个文件夹名为需要复制的目录结构的顶级文件夹名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Copy-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse 源路径 目标路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Filter")]),t._v(" 文件名\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .create()方法可以创建不存在的目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[IO.DirectoryInfo]")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$to")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 复制多个文件到指定目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\demo"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("include @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.java'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy-item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("destination "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("new-item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(':HOMEPATH\\Desktop\\demo"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"directory"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 递归复制目录结构(可指定多个文件或文件夹)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$prjName")]),t._v("="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("`\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$srcFolder")]),t._v("= "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join-path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Users\\d\\Downloads"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$prjName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("`\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$descFolder")]),t._v("= "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join-path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\Users\\d\\Desktop"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$prjName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("`\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$srcFolder")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("include @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1.txt'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1.xml'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse`\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ForEach-object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_PSIsContainer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("`\n        robocopy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ndl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("njh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("njs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("s "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_fullname")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_fullname")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-replace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[regex]")]),t._v("::Escape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$srcFolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$descFolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("`\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("`\n        robocopy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ndl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("njh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("njs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("s "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$srcFolder")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$descFolder")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name`\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("删除空目录")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" `\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FullName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force `\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" Where "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" `\n@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Lit "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Fullname "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" Where "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" 0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ? "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-match")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DirectoryInfo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ?"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetFiles"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" 0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetDirectories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" 0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" where "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("force "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fullname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force\n")])])]),s("ul",[s("li",[t._v("递归删除排除之外的文件")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 源路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Include "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Exclude @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.css'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse\n")])])]),s("ul",[s("li",[t._v("删除旧文件（指定日期之前的）")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" Where "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" `\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LastWriteTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddDays"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("31"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddDays"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("15"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ? "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-match")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FileInfo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ?"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LastWriteTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[datetime]")]),t._v("::now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("adddays"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("30"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force\n")])])]),s("ul",[s("li",[t._v("格式化时间")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Format "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyy-MM-dd hh:mm:ss'")]),t._v("\n")])])]),s("p",[s("strong",[t._v("调用DLL")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("DllImport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kernel32.dll"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nprivate static extern int GetPrivateProfileSection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string lpAppName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" byte"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" lpszReturnBuffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int nSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" string lpFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Lock-WorkStation")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$signature")]),t._v(" = @"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n        [DllImport("')]),t._v("user32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dll"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('", SetLastError = true)]\n        public static extern bool LockWorkStation();\n    "')]),t._v("@\n    \n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$LockWorkStation")]),t._v(" = "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("memberDefinition "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$signature")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Win32LockWorkStation"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("namespace Win32Functions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("passthru\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$LockWorkStation")]),t._v("::LockWorkStation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-Null")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("查看进程启动参数")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有进程")]),t._v("\nwmic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" get caption"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("commandline "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("value\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看单个进程")]),t._v("\nwmic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" where caption="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"svchost.exe"')]),t._v(" get caption"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("commandline "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("value\nwmic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" get caption"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("commandline "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" findstr "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"svchost.exe"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("解压zip")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.archive",target:"_blank",rel:"noopener noreferrer"}},[t._v("压缩解压文件"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/ahxdyz/article/details/93534213",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell-压缩解压缩文件"),s("OutboundLink")],1)])]),t._v(" "),s("ul",[s("li",[t._v("PowerShell 5.0或更高版本(已预安装Windows 10和Windows Server 2016)")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Compress-Archive")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 解压到目录路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DestinationPath 压缩文件路径\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Expand-Archive")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 解压到目录路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DestinationPath 压缩文件路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force:"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Overwrite")]),t._v("\n")])])]),s("ul",[s("li",[t._v("需要.net 4.5以上")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("assembly "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"system.io.compression.filesystem"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[io.compression.zipfile]")]),t._v("::ExtractToDirectory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("压缩文件路径"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 解压到目录路径"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("PowerShell 2.0以上")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" UnzipFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[string]")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sourceFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[string]")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Test-Path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        mkdir "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$shellApp")]),t._v(" = "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ComObject Shell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Application\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$files")]),t._v(" = "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$shellApp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NameSpace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$souceFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# foreach ($item in $files) {")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     $shell.Namespace($targetFolder).CopyHere($item)")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# }")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$shellApp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NameSpace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CopyHere"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$files")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"事件计划任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件计划任务"}},[t._v("#")]),t._v(" 事件计划任务")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.holoem.com/?p=1974",target:"_blank",rel:"noopener noreferrer"}},[t._v("Scheduled Tasks（计划任务）"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("strong",[t._v("使用Get-WinEvent")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.diagnostics/get-winevent",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-WinEvent"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Help")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("logname="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'system'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MaxEvents 1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出所有事件日志")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ListLog "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# powershell管理员权限下获取安全事件日志")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FilterHashtable @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LogName="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Security'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过滤安全事件ID 4624")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FilterHashtable @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LogName="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Security'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("ID="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'4624'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询今天的应用和系统日志，显示前2条")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("logname="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'system'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("starttime="),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[datetime]")]),t._v("::today "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MaxEvents 2\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据ID查询事件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName Microsoft-Windows-PowerShell/Operational "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4100"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-or")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4104"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询指定时间内的事件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StartTime")]),t._v("="),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Year  2020  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Month  3  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Day  1  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Hour  15  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Minute  30\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$EndTime")]),t._v("="),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Year  2020  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Month  3  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Day  15  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Hour  20  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Minute  00\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FilterHashtable @"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LogName="),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'System'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("StartTime="),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StartTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("EndTime="),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$EndTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("使用Get-EventLog")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.management/get-eventlog",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-EventLog"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.pstips.net/monitoring-eventlog.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell 监听事件日志"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.pstips.net/get-sleep-and-hibernation-times.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Powershell获取睡眠时间"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Help")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 按 EventID 将事件进行分组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),t._v(" EventID\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fl 是 Format-List 的别名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Newest 1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" TimeGenerated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Message\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" TimeGenerated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Message "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" message\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" TimeGenerated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Message "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" message "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ft")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Wrap\n")])])]),s("p",[s("strong",[t._v("定时任务")])]),t._v(" "),s("ul",[s("li",[t._v("查看支持的命令")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Command")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Module ScheduledTasks\n")])])]),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 此例子为每5分钟一次的定时任务，通过设置$step和$add可以实现延时执行任务。 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" waitsec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$step")]),t._v("=300 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置间隔")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$add")]),t._v("=0 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置延时")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),t._v("="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$step")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hour*3600+"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Minute*60+"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Second"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$step")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$add")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write-host")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"running...... please wait"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitsec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"S"')]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Start-Sleep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("s "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitsec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行代码")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-date")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Start-Sleep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("s "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitsec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.csdn.net/weixin_39775577/article/details/113628194",target:"_blank",rel:"noopener noreferrer"}},[t._v("Powershell基础入门及常见用法"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/9682024/how-to-do-what-head-tail-more-less-sed-do-in-powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to do what head, tail, more, less, sed do in Powershell?"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看别名对应的真实命令")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-alias")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看命名位置（类似 Linux Shell 的 which）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-command")]),t._v(" xxx\ngcm xxx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过关键字查找 powershell 命令")]),t._v("\ngcm "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <keyword>\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过关键字查找 powershell 命令和环境变量中的程序，比较慢")]),t._v("\ngcm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <keyword>\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 类似 linux 的 find/ls 命令")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Include "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清空终端的输出")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear-host")]),t._v("\nclear\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看文件内容")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-content")]),t._v(" xx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-content")]),t._v(" xx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("out-host")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("paging\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" xx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" xx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ReadCount是指每次发送给管道的文本行数，0代表全部")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Tail只返回指定结尾行数的文本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -wait 一直等待监听")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Content")]),t._v(" 文件路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ReadCount 0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Tail 5 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Wait\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编码转换 [System.Text.Encoding]::ASCII")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Content")]),t._v(" filename1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("encoding default "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set-content")]),t._v(" filename2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("encoding utf8\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("first 10 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# head")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("head 10\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("TotalCount 10 log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# also head")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ReadCount 5 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pipeline end!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# head")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("last 10  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tail")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Tail 10 log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# also tail (since PSv3), also much faster than above option")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or less if you have it installed")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-replace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\d+'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'($0)'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sed Where-Object Foreach-Object Select-Object")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v("=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-gt")]),t._v(" 2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" 7"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sed")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v("=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat -n")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 字符串搜索，不能对对象使用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 类似 linux 的 grep 命令")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <pattern>\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("out-string")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <pattern>  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要先使用 out-string 将对象转换成 string")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("where-object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-like")]),t._v(" <pattern>"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计算输出的行数/对象个数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("measure-object")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("measure")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这是缩写")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 别名")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查找某进程（替代掉 tasklist）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name exp*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("power*  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用正则查找进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <pattern>  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 效果同上")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过 id 杀掉某进程（替代掉 taskkill）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 也可以通过 -Name 用正则匹配进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop-process")]),t._v(" <pid>\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" <pid>  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 别名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name 名称 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Stop-Process")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name 名称 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("foreach-object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Kill")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WmiObject")]),t._v(" Win32_Process "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Filter")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"name = 'notepad.exe'\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ForEach-Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Terminate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-Null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WmiObject")]),t._v(" Win32_Process "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Filter")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"name = 'notepad.exe'\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Invoke-WmiMethod")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name Terminate "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-Null")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据模块（dll）查找进程并结束进程")]),t._v("\n```powershell\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Modules "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ModuleName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NsCopyHook3.dll"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Stop-Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Start-Process")]),t._v(" explorer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Modules"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ModuleName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-contains")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NsCopyHook3.dll'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Stop-Process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Start-Process")]),t._v(" explorer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe\n")])])]),s("h1",{attrs:{id:"网络相关命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#网络相关命令"}},[t._v("#")]),t._v(" 网络相关命令")]),t._v(" "),s("p",[s("strong",[t._v("1. dns 相关(dns-client)")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Clear-DnsClientCache")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清除 dns 缓存（替换掉 `ipconfig /flushdns`）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-DnsClientCache")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 dns 缓存")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Resolve-DnsName")]),t._v(" baidu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解析域名")]),t._v("\n")])])]),s("p",[s("strong",[t._v("2. TCP/IP 相关命令")])]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Command")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Net")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有 TCP/IP 相关的命令")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetIPAddress")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 IP 地址")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetIPInterface")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 IP 接口")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetRoute")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看路由表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetNeighbor")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取链路层 MAC 地址缓存")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetTCPConnection")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 TCP 连接")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("### 也可以对 TCP/IP 的 IP 地址、接口、路由表进行增删改")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-NetRoute")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-NetNeighbor")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清除 MAC 地址缓存")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关机/重启")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop-computer")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("restart-computer")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows 计算 hash 值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 功能等同于 linux 下的 sha256sum/sha1sum/sha512sum/md5sum")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-FileHash")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path/to/file "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Algorithm SHA256\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-FileHash")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path/to/file "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Algorithm SHA256  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Format-List")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用 format 修改格式化效果")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# base64 编解码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Convert]")]),t._v("::ToBase64String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Text.Encoding]")]),t._v("::UTF8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetBytes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# base64 编码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Text.Encoding]")]),t._v("::UTF8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Convert]")]),t._v("::FromBase64String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eHh4"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解码")]),t._v("\n")])])])])},[],!1,null,null,null);s.default=e.exports}}]);