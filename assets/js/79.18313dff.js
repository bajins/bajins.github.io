(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{293:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"bat执行javascript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bat执行javascript","aria-hidden":"true"}},[s._v("#")]),s._v(" bat执行JavaScript")]),s._v(" "),a("blockquote",[a("p",[s._v("原理：把bat命令用JavaScript注释"),a("code",[s._v("/**/")]),s._v("包裹住，然后用bat命令执行文件中的JavaScript代码时就不会编译bat命令了")])]),s._v(" "),a("h2",{attrs:{id:"下载文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 下载文件")]),s._v(" "),a("h3",{attrs:{id:"方式一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式一","aria-hidden":"true"}},[s._v("#")]),s._v(" 方式一")]),s._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("1")]),s._v(">"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/* :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("::  bajins 1.0.0  by bajins https://batch.bajins.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 首发兼更新地址:https://batch.bajins.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("::")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 使用时请将bajins.bat放入任意一个PATH中的目录以便调用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 但请确保bajins.bat拥有该目录的读写权限(因此最好不要选择system32)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 建议新建一个目录专供bajins.bat使用,再将这个目录添加到PATH中")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" off")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("md")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(">nul")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exist")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" bajins不具备所在目录的写入权限! >")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("2")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 开启延迟环境变量扩展")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("setlocal")]),s._v(" enabledelayedexpansion")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(':: cscript -nologo -e:jscript "%~f0" 这一段是执行命令，后面的是参数（组成方式：/key:value）')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: %~f0 表示当前批处理的绝对路径,去掉引号的完整路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~2")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 结束延迟环境变量扩展和命令执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("endlocal")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%errorlevel%")])]),s._v("\n*/\n\n// ****************************  JavaScript  *******************************\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" iRemote = WScript.Arguments("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("iRemote")]),s._v(" = iRemote.toLowerCase(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" iLocal = WScript.Arguments("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("iLocal")]),s._v(" = iLocal.toLowerCase(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v('+ "\\\\" + iRemote.substring'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("iRemote")]),s._v(".lastIndexOf("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" + 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" xPost = new ActiveXObject("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Microsoft.XMLHTTP"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("xPost")]),s._v(".Open("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET"')]),s._v(", iRemote, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("xPost")]),s._v(".Send(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" sGet = new ActiveXObject("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ADODB.Stream"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sGet")]),s._v(".Mode = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sGet")]),s._v(".Type = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sGet")]),s._v(".Open(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sGet")]),s._v(".Write(xPost.responseBody")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sGet")]),s._v(".SaveToFile(iLocal, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sGet")]),s._v(".Close(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n")])])]),a("blockquote",[a("p",[s._v("以下两种方式仅是传参和取参方式的不同")])]),s._v(" "),a("h3",{attrs:{id:"方式二"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式二","aria-hidden":"true"}},[s._v("#")]),s._v(" 方式二")]),s._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("1")]),s._v(">"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/* :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("::  bajins 1.0.0  by bajins https://batch.bajins.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 首发兼更新地址:https://batch.bajins.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("::")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 使用时请将bajins.bat放入任意一个PATH中的目录以便调用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 但请确保bajins.bat拥有该目录的读写权限(因此最好不要选择system32)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 建议新建一个目录专供bajins.bat使用,再将这个目录添加到PATH中")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" off")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("md")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(">nul")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exist")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" bajins不具备所在目录的写入权限! >")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("2")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 开启延迟环境变量扩展")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("setlocal")]),s._v(" enabledelayedexpansion")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/?"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/func"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")])]),s._v("help")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/func"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")])]),s._v("help")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~2"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/func"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")])]),s._v("help")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(':: cscript -nologo -e:jscript "%~f0" 这一段是执行命令，后面的是参数（组成方式：/key:value）')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: %~f0 表示当前批处理的绝对路径,去掉引号的完整路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/func"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")])]),s._v("download "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")])]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")])]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~2")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 结束延迟环境变量扩展和命令执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("endlocal")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%errorlevel%")])]),s._v("\n*/\n\n// ****************************  JavaScript  *******************************\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" Argv = WScript.Arguments;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" (i = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("; i < Argv.Length; i++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"参数："')]),s._v(" + Argv(i")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" ArgvName = Argv.Named;")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" func = ArgvName.Item('func'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (func == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("help")]),s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n} else if "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"download"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("download")]),s._v("(ArgvName.Item('url'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", ArgvName.Item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n} else if "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error")]),s._v("(ArgvName.Item('msg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n} else if "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"info"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("(ArgvName.Item('msg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WScript")]),s._v(".Quit("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" error(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WScript")]),s._v(".StdErr.WriteLine(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" info(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WScript")]),s._v(".StdOut.WriteLine(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" help(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"基本用法:"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"   下载: bajins url path"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"     url 下载链接"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"     path 下载的文件保存地址，不传则保存到当前文件夹"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" download(url, path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" FSO = new ActiveXObject('Scripting.FileSystemObject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" SavePath = FSO.GetFile(WScript.ScriptFullName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".ParentFolder.Path;\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (path != ''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SavePath")]),s._v(" = path;")]),s._v("\n    }\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SavePath")]),s._v(" = SavePath + "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\\\"')]),s._v(" + url.substring(url.lastIndexOf("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" + 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    //下载方式,留空则使用内建下载.可以使用其他第三方,例:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v('wget -q "$URL" -O "$SavePath"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" DownMode = '';")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (DownMode == ''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" XMLHTTP = new ActiveXObject('Microsoft.XMLHTTP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("XMLHTTP")]),s._v(".Open('GET', url, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("XMLHTTP")]),s._v(".Send(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" ADO = new ActiveXObject('ADODB.Stream'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Mode = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Type = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Open(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Write(XMLHTTP.ResponseBody")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".SaveToFile(SavePath, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Close(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    } else {\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" WShell = new ActiveXObject('WScript.Shell'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WShell")]),s._v(".Run(DownMode.replace(/\\$URL/, url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/\\$SavePath/, SavePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", 0, true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    }\n}\n")])])]),a("h3",{attrs:{id:"方式三"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式三","aria-hidden":"true"}},[s._v("#")]),s._v(" 方式三")]),s._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("1")]),s._v(">"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/* :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("::  bajins 1.0.0  by bajins https://batch.bajins.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 首发兼更新地址:https://batch.bajins.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("::")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 使用时请将bajins.bat放入任意一个PATH中的目录以便调用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 但请确保bajins.bat拥有该目录的读写权限(因此最好不要选择system32)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 建议新建一个目录专供bajins.bat使用,再将这个目录添加到PATH中")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" off")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("md")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(">nul")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exist")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" bajins不具备所在目录的写入权限! >")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("2")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~dp0$testAdmin$"')])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 开启延迟环境变量扩展")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("setlocal")]),s._v(" enabledelayedexpansion")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/?"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" help")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" help")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~2"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" help")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(':: cscript -nologo -e:jscript "%~f0" 这一段是执行命令，后面的是参数')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: %~f0 表示当前批处理的绝对路径,去掉引号的完整路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cscript")]),s._v(" -nologo "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("-e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":jscript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%~f0"')]),s._v(" download "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%~9")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v(":EXIT")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v(":: 结束延迟环境变量扩展和命令执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("endlocal")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%errorlevel%")])]),s._v("\n*/\n\n// ****************************  JavaScript  *******************************\n\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" Argv = WScript.Arguments;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" (i = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("; i < Argv.Length; i++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"参数："')]),s._v(" + Argv(i")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" func = Argv("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (func == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("help")]),s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n} else if "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"download"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" url = Argv("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" path = Argv("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("download")]),s._v("(url, path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n} else if "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error")]),s._v("(Argv("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n} else if "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" == "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"info"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("(Argv("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WScript")]),s._v(".Quit("),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" error(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WScript")]),s._v(".StdErr.WriteLine(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" info(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WScript")]),s._v(".StdOut.WriteLine(msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" help(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"基本用法:"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"   下载: bajins url path"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"     url 下载链接"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("info")]),s._v("("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"     path 下载的文件保存地址，不传则保存到当前文件夹"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n}\n\n"),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" download(url, path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" FSO = new ActiveXObject('Scripting.FileSystemObject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" SavePath = FSO.GetFile(WScript.ScriptFullName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".ParentFolder.Path;\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (path != ''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SavePath")]),s._v(" = path;")]),s._v("\n    }\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SavePath")]),s._v(" = SavePath + "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\\\"')]),s._v(" + url.substring(url.lastIndexOf("),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" + 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    //下载方式,留空则使用内建下载.可以使用其他第三方,例:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v('wget -q "$URL" -O "$SavePath"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" DownMode = '';")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (DownMode == ''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" XMLHTTP = new ActiveXObject('Microsoft.XMLHTTP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("XMLHTTP")]),s._v(".Open('GET', url, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("XMLHTTP")]),s._v(".Send(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" ADO = new ActiveXObject('ADODB.Stream'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Mode = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Type = "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Open(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Write(XMLHTTP.ResponseBody")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".SaveToFile(SavePath, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADO")]),s._v(".Close(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    } else {\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" WShell = new ActiveXObject('WScript.Shell'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n        "),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WShell")]),s._v(".Run(DownMode.replace(/\\$URL/, url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/\\$SavePath/, SavePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", 0, true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(";\n    }\n}\n")])])])])},[],!1,null,null,null);t.default=e.exports}}]);