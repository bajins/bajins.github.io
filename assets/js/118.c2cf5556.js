(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{465:function(t,a,e){"use strict";e.r(a);var s=e(0),r=Object(s.a)({},function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"邮箱服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#邮箱服务"}},[t._v("#")]),t._v(" 邮箱服务")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),a("li",[a("a",{attrs:{href:"#域名邮箱"}},[t._v("域名邮箱")]),a("ul",[a("li",[a("a",{attrs:{href:"#yandex配置步骤"}},[t._v("Yandex配置步骤")])])])]),a("li",[a("a",{attrs:{href:"#邮件服务器"}},[t._v("邮件服务器")]),a("ul",[a("li",[a("a",{attrs:{href:"#邮件服务器概述"}},[t._v("邮件服务器概述")])]),a("li",[a("a",{attrs:{href:"#设置域名解析"}},[t._v("设置域名解析")])]),a("li",[a("a",{attrs:{href:"#卸载sendmail"}},[t._v("卸载sendmail")])]),a("li",[a("a",{attrs:{href:"#安装-postfix-和dovecot"}},[t._v("安装Postfix和Dovecot")])]),a("li",[a("a",{attrs:{href:"#查看版本"}},[t._v("查看版本")])]),a("li",[a("a",{attrs:{href:"#修改邮件传输代理"}},[t._v("修改邮件传输代理")])]),a("li",[a("a",{attrs:{href:"#查看是否修改成功"}},[t._v("查看是否修改成功")])]),a("li",[a("a",{attrs:{href:"#修改postfix配置"}},[t._v("修改Postfix配置")])]),a("li",[a("a",{attrs:{href:"#修改dovecot配置"}},[t._v("修改Dovecot配置")])]),a("li",[a("a",{attrs:{href:"#修改防火墙配置"}},[t._v("修改防火墙配置")])]),a("li",[a("a",{attrs:{href:"#配置用户及权限"}},[t._v("配置用户及权限")])]),a("li",[a("a",{attrs:{href:"#启动服务"}},[t._v("启动服务")])]),a("li",[a("a",{attrs:{href:"#使用mail测试发信"}},[t._v("使用mail测试发信")])]),a("li",[a("a",{attrs:{href:"#使用telnet测试收信"}},[t._v("使用telnet测试收信")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://dkim.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://dkim.org"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://tourcoder.com/install-postfix-on-centos-7",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://tourcoder.com/install-postfix-on-centos-7/"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/denghongcai/forsaken-mail",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/denghongcai/forsaken-mail"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/malaohu/forsaken-mail",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/malaohu/forsaken-mail"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/flashmob/go-guerrilla",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/flashmob/go-guerrilla"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/PHPMailer",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/PHPMailer"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/knadh/listmonk",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/knadh/listmonk"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/postalserver/postal",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/postalserver/postal"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/albertito/chasquid",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/albertito/chasquid"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/Exim/exim",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/Exim/exim"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/vdukhovni/postfix",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/vdukhovni/postfix"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/postfixadmin/postfixadmin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/postfixadmin/postfixadmin"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/mailserver2/mailserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/mailserver2/mailserver"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/docker-mailserver/docker-mailserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/docker-mailserver/docker-mailserver"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://sendmail.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://sendmail.org"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/marlam/msmtp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/marlam/msmtp"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://sourceforge.net/projects/dkim-milter",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://sourceforge.net/projects/dkim-milter"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://sourceforge.net/projects/opendkim",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://sourceforge.net/projects/opendkim"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/yesmore/vmail",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/yesmore/vmail"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/mail-in-a-box/mailinabox",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/mail-in-a-box/mailinabox"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.mail-tester.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("测试邮箱"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("邮件营销 "),a("a",{attrs:{href:"https://github.com/aaPanel/BillionMail",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/aaPanel/BillionMail"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"域名邮箱"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#域名邮箱"}},[t._v("#")]),t._v(" 域名邮箱")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.bt.cn/bbs/thread-32749-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("宝塔邮局管理器"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.httpsmail.com/hosting",target:"_blank",rel:"noopener noreferrer"}},[t._v("httpsmail"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://mksaas.me/blog/email",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用Gmail+Resend+Cloudflare搭建免费的企业邮箱"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"yandex配置步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yandex配置步骤"}},[t._v("#")]),t._v(" Yandex配置步骤")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://hky.moe/archives/21",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://hky.moe/archives/21"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("端口")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("SMTP")]),t._v("："),a("code",[t._v("smtp.yandex.com:465 SSL")])]),t._v(" "),a("li",[a("code",[t._v("IMAP")]),t._v("："),a("code",[t._v("imap.yandex.com:993 SSL")])]),t._v(" "),a("li",[a("code",[t._v("POP3")]),t._v("："),a("code",[t._v("pop.yandex.com:995 SSL")])])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：如果是添加第二个域名（一个域名是一个组织），进入"),a("a",{attrs:{href:"https://connect.yandex.com/portal/admin",target:"_blank",rel:"noopener noreferrer"}},[t._v("账户管理页面"),a("OutboundLink")],1),t._v("，\n然后点击顶部的域名后弹出下拉菜单有一个"),a("code",[t._v("New organization")]),t._v("按钮来添加新域名，然后按照步骤（跳过1、2）操作即可")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("1、注册账户 "),a("a",{attrs:{href:"https://mail.yandex.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mail.yandex.com"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("2、添加域名 "),a("a",{attrs:{href:"https://connect.yandex.com/pdd",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://connect.yandex.com/pdd/"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("3、验证域名所有权")])])]),t._v(" "),a("blockquote",[a("p",[t._v("此时已经进入到管理页面，在左侧菜单"),a("code",[t._v("Domains")]),t._v("中点击域名（此时域名右侧是"),a("code",[t._v("禁止符号")]),t._v("）验证域名所有权，\n验证成功后左侧菜单栏会多出几个菜单（这时域名右侧是"),a("code",[t._v("感叹号")]),t._v("）")])]),t._v(" "),a("ul",[a("li",[t._v("4、DNS配置"),a("code",[t._v("SPF Record")]),t._v("、"),a("code",[t._v("MX")]),t._v("、二级域名 "),a("a",{attrs:{href:"https://connect.yandex.com/portal/admin/customization/dns",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://connect.yandex.com/portal/admin/customization/dns"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("按照上面链接中的DNS配置（或者点击左侧菜单栏"),a("code",[t._v("DNS management")]),t._v("）到自己域名所在服务商添加DNS解析，\n注意末尾的点不要丢了，等待几分钟刷新（域名右侧是"),a("code",[t._v("绿色的勾")]),t._v("）")])]),t._v(" "),a("ul",[a("li",[t._v("5、DNS配置"),a("code",[t._v("DKIM signature")]),t._v(" "),a("a",{attrs:{href:"https://connect.yandex.com/portal/admin/customization/mail",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://connect.yandex.com/portal/admin/customization/mail"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("点击上面的连接（就是左侧"),a("code",[t._v("Email")]),t._v("菜单）进入界面后点击"),a("code",[t._v("DKIM signatures")]),t._v("点击"),a("code",[t._v("Copy")]),t._v(",然后在域名所在服务商添加一条TXT记录DNS解析，\n主机记录（name）为"),a("code",[t._v("mail._domainkey")]),t._v(",值就是刚刚复制的"),a("code",[t._v("DKIM signatures")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/YandexMailDNS.png",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("6、添加邮箱账户")])]),t._v(" "),a("blockquote",[a("p",[t._v("点击 "),a("code",[t._v("Все сотрудники")]),t._v("（就是左侧第一个菜单），然后点击页面下方有一个带"),a("code",[t._v("+")]),t._v("的"),a("code",[t._v("add")]),t._v("按钮，\n再点击"),a("code",[t._v("Add a person")]),t._v("，在弹出的页面输入，带"),a("code",[t._v("*")]),t._v("的为必填，填完后就点击"),a("code",[t._v("橙色的add按钮")])])]),t._v(" "),a("ul",[a("li",[t._v("7、新添加的账户需要去登录并同意一个协议才能使用")])]),t._v(" "),a("blockquote",[a("p",[t._v("点击"),a("a",{attrs:{href:"https://mail.yandex.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mail.yandex.com"),a("OutboundLink")],1),t._v("登录新账户并点击"),a("code",[t._v("Complete registration")]),t._v("按钮同意协议")])]),t._v(" "),a("ul",[a("li",[t._v("8、pop3/imap无法使用的解决办法")])]),t._v(" "),a("blockquote",[a("p",[t._v("点击"),a("a",{attrs:{href:"https://mail.yandex.com/#setup/client",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mail.yandex.com/#setup/client"),a("OutboundLink")],1),t._v("\n登陆邮箱按照下图中步骤操作即可，登录后重新点击链接可省略下图中的1、2、3步")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/Yandex%E8%A7%A3%E5%86%B3POP3%E6%97%A0%E6%B3%95%E6%94%B6%E5%8F%96%E9%82%AE%E4%BB%B6.png",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("9、域名验证不通过解决办法")])]),t._v(" "),a("blockquote",[a("p",[t._v("进入"),a("a",{attrs:{href:"https://webmaster.yandex.com/sites",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webmaster.yandex.com/sites"),a("OutboundLink")],1),t._v("点击没有通过验证域名上的"),a("code",[t._v("X")]),t._v("按钮进行删除，\n然后点击页面顶部的"),a("code",[t._v("+")]),t._v("按钮重新添加域名再验证。")])]),t._v(" "),a("blockquote",[a("p",[t._v("我的域名验证不通过发现是因为：添加不带"),a("code",[t._v("www")]),t._v("的域名，自动添加了"),a("code",[t._v("www")]),t._v("二级域名")])]),t._v(" "),a("p",[a("strong",[t._v("验证码填写")])]),t._v(" "),a("ul",[a("li",[t._v("使用Google翻译的软键盘")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/google%E7%BF%BB%E8%AF%91%E4%BF%84%E8%AF%AD%E8%BD%AF%E9%94%AE%E7%9B%98.png",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("使用"),a("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E4%BF%84%E8%AF%AD%E5%AD%97%E6%AF%8D",target:"_blank",rel:"noopener noreferrer"}},[t._v("俄语字母表"),a("OutboundLink")],1),t._v("一个个复制粘贴")])]),t._v(" "),a("h2",{attrs:{id:"邮件服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#邮件服务器"}},[t._v("#")]),t._v(" 邮件服务器")]),t._v(" "),a("h3",{attrs:{id:"邮件服务器概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#邮件服务器概述"}},[t._v("#")]),t._v(" 邮件服务器概述")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("MUA")]),t._v("："),a("code",[t._v("Mail User Agent")]),t._v("，邮件用户代理")])]),t._v(" "),a("blockquote",[a("p",[t._v("接收邮件所使用的邮件客户端，使用"),a("code",[t._v("IMAP")]),t._v("或"),a("code",[t._v("POP3")]),t._v("协议与服务器通信；")]),t._v(" "),a("p",[t._v("如："),a("code",[t._v("Outlook")]),t._v("、"),a("code",[t._v("Foxmail")]),t._v("、"),a("code",[t._v("thunderbird")]),t._v("、"),a("code",[t._v("Mac Mail")]),t._v("、"),a("code",[t._v("mutt")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("MTA")]),t._v("："),a("code",[t._v("Mail Transfer Agent")]),t._v("，邮件传输代理代为传递")])]),t._v(" "),a("blockquote",[a("p",[t._v("通过"),a("code",[t._v("SMTP")]),t._v("协议发送、转发邮件；")]),t._v(" "),a("p",[t._v("如："),a("code",[t._v("Sendmail")]),t._v("、"),a("code",[t._v("Postfix")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("MDA")]),t._v("："),a("code",[t._v("Mail Delivery Agent")]),t._v("，邮件投递代理")])]),t._v(" "),a("blockquote",[a("p",[t._v("将"),a("code",[t._v("MTA")]),t._v("接收到的邮件保存到磁盘或指定地方，通常会进行垃圾邮件及病毒扫描；")]),t._v(" "),a("p",[t._v("如："),a("code",[t._v("procmail")]),t._v("、"),a("code",[t._v("dropmail")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("MRA")]),t._v("："),a("code",[t._v("Mail Receive Agent")]),t._v("，邮件接收代理")])]),t._v(" "),a("blockquote",[a("p",[t._v("负责实现"),a("code",[t._v("IMAP")]),t._v("与"),a("code",[t._v("POP")]),t._v("3协议，与"),a("code",[t._v("MUA")]),t._v("进行交互；")]),t._v(" "),a("p",[t._v("如："),a("code",[t._v("dovecot")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("SMTP")]),t._v("："),a("code",[t._v("Simple Mail Transfer Protocol")]),t._v("，传输发送邮件所使用的标准协议；")]),t._v(" "),a("li",[a("code",[t._v("IMAP")]),t._v("："),a("code",[t._v("Internet Message Access Protocol")]),t._v("，接收邮件使用的标准协议之一；")]),t._v(" "),a("li",[a("code",[t._v("POP3")]),t._v("："),a("code",[t._v("Post Office Protocol 3")]),t._v("，接收邮件使用的标准协议之一。")])]),t._v(" "),a("p",[a("strong",[t._v("流程")])]),t._v(" "),a("blockquote",[a("p",[t._v("邮件服务器基本都有"),a("code",[t._v("MTA")]),t._v("，"),a("code",[t._v("MDA")]),t._v("，"),a("code",[t._v("MRA")]),t._v("组成")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("MUA")]),t._v("(发件人发送) --\x3e (若干个)"),a("code",[t._v("MTA")]),t._v(" --\x3e "),a("code",[t._v("MDA")]),t._v(" --\x3e "),a("code",[t._v("MRA")]),t._v(" <–- "),a("code",[t._v("MUA")]),t._v("(收件人收取)")])]),t._v(" "),a("blockquote",[a("p",[t._v("协议："),a("code",[t._v("MUA")]),t._v("到"),a("code",[t._v("MTA")]),t._v("，以及"),a("code",[t._v("MTA")]),t._v("到"),a("code",[t._v("MTA")]),t._v("之间使用"),a("code",[t._v("SMTP")]),t._v("协议，而收邮件时，"),a("code",[t._v("MUA")]),t._v("到"),a("code",[t._v("MDA")]),t._v("之间使用"),a("code",[t._v("POP3")]),t._v("或"),a("code",[t._v("IMAP")]),t._v("协议。")])]),t._v(" "),a("ul",[a("li",[t._v("一、用户利用"),a("code",[t._v("MUA")]),t._v("寄信到"),a("code",[t._v("MTA")]),t._v("。配置"),a("code",[t._v("MUA")]),t._v("时要配上"),a("code",[t._v("SMTP")]),t._v("服务器域名,然后发送邮件。\n"),a("ul",[a("li",[t._v("比如使用网易账户发送邮件就要在配置"),a("code",[t._v("smtp.163.com")]),t._v(",这样邮件就发送到网易"),a("code",[t._v("MTA")]),t._v("。")])])]),t._v(" "),a("li",[t._v("二、 "),a("code",[t._v("MTA")]),t._v("检查收件人服务器如果不是自己则传递到下一跳"),a("code",[t._v("MTA")]),t._v("，直到传递到目的"),a("code",[t._v("MTA")]),t._v("。")]),t._v(" "),a("li",[t._v("三、 目的"),a("code",[t._v("MTA")]),t._v("收到邮件后将邮件存储到"),a("code",[t._v("MDA")]),t._v("中，"),a("code",[t._v("MDA")]),t._v("对邮件进行垃圾过滤，病毒查杀。")]),t._v(" "),a("li",[t._v("四、 "),a("code",[t._v("MRA")]),t._v("把邮件从"),a("code",[t._v("MDA")]),t._v("收取到用户的收件箱中。")]),t._v(" "),a("li",[t._v("五、 "),a("code",[t._v("MUA")]),t._v("收取邮件，此时收取邮件只是将"),a("code",[t._v("MRA")]),t._v("中的邮件下载到本地。")])]),t._v(" "),a("h3",{attrs:{id:"设置域名解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置域名解析"}},[t._v("#")]),t._v(" 设置域名解析")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("记录类型")]),t._v(" "),a("th",[t._v("主机记录")]),t._v(" "),a("th",[t._v("解析线路(isp)")]),t._v(" "),a("th",[t._v("记录值")]),t._v(" "),a("th",[t._v("MX优先级")]),t._v(" "),a("th",[t._v("TTL值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("A")]),t._v(" "),a("td",[t._v("mail")]),t._v(" "),a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("服务器IP地址")]),t._v(" "),a("td",[t._v("–")]),t._v(" "),a("td",[t._v("10 分钟")])]),t._v(" "),a("tr",[a("td",[t._v("MX")]),t._v(" "),a("td",[t._v("@")]),t._v(" "),a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("mail.域名")]),t._v(" "),a("td",[t._v("10")]),t._v(" "),a("td",[t._v("10 分钟")])])])]),t._v(" "),a("h3",{attrs:{id:"卸载sendmail"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#卸载sendmail"}},[t._v("#")]),t._v(" 卸载sendmail")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum remove "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendmail")]),t._v("\n")])])]),a("h3",{attrs:{id:"安装postfix和dovecot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装postfix和dovecot"}},[t._v("#")]),t._v(" 安装"),a("code",[t._v("Postfix")]),t._v("和Dovecot")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" postfix dovecot\n")])])]),a("h3",{attrs:{id:"查看版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看版本"}},[t._v("#")]),t._v(" 查看版本")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-qa")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postfix\\|dovecot"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-qa")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" postfix "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" dovecot\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-qa")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-E")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postfix|dovecot"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-qa")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("egrep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postfix|dovecot"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-qa")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/postfix|dovecot/"')]),t._v("\n")])])]),a("h3",{attrs:{id:"修改邮件传输代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改邮件传输代理"}},[t._v("#")]),t._v(" 修改邮件传输代理")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("alternatives "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--config")]),t._v(" mta\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者先查看邮件传输代理程序，再设置")]),t._v("\n/usr/sbin/alternatives "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--set")]),t._v(" mta /usr/sbin/sendmail.postfix\n")])])]),a("blockquote",[a("p",[t._v("会提示找到几个可用程序，输入自己需要的那个程序的数字即可")])]),t._v(" "),a("h3",{attrs:{id:"查看是否修改成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看是否修改成功"}},[t._v("#")]),t._v(" 查看是否修改成功")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("alternatives "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--display")]),t._v(" mta\n")])])]),a("blockquote",[a("p",[t._v("第一行显示"),a("code",[t._v("mta - status is manual.")]),t._v("则表示设置成功")])]),t._v(" "),a("h3",{attrs:{id:"修改postfix配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改postfix配置"}},[t._v("#")]),t._v(" 修改Postfix配置")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://blog.leanote.com/post/colin_xia@yeah.net/postfix-%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://blog.leanote.com/post/colin_xia@yeah.net/postfix-官方文档笔记"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/operationhome/p/9056870.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cnblogs.com/operationhome/p/9056870.html"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("在"),a("code",[t._v("main.cf")]),t._v("中配置的值会自动分散到多个指定的配置文件中去")])]),t._v(" "),a("p",[a("strong",[t._v("查看配置")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出所有postfix配置项以及默认值")]),t._v("\npostconf\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不输出#开头和空行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^#\\|^$'")]),t._v(" /etc/postfix/main.cf\n")])])]),a("p",[a("strong",[t._v("编辑配置")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/postfix/main.cf\n")])])]),a("p",[a("strong",[t._v("修改以下内容")])]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 75行:主机名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("myhostname")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("mail.example.com")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 83行:设置本地网络的邮件域")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("mydomain")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("example.com")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 99行:要外发邮件时发件人的邮件域名，这里取的mydomain变量值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("myorigin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("$mydomain")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 116行:默认是localhost，修改成all，即监听所有网络接口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("inet_interfaces")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("all")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 119行:网络协议 ipv6、ipv4或者all")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("inet_protocols")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("all")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 164行:设置可接收邮件的主机名或域名，来自其他主机名或域名的邮件将拒绝接收")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("mydestination")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("$myhostname, localhost.$mydomain, localhost, $mydomain")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 210行:制定接收邮件的规则，可以是hash文件，可以直接注释")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("local_recipient_maps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 264行:收发客户端的地址")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("mynetworks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("0.0.0.0/0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 296行:设置可转发来自哪些域名或主机名的邮件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("relay_domains")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("$mydestination")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 419行:邮件存储的位置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("home_mailbox")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("Maildir/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 572行:指定MUA通过smtp连接postfix时返回的header头信息，定义欢迎信息")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_banner")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("$myhostname ESMTP $mail_name")]),t._v("\n")])])]),a("p",[a("strong",[t._v("在文件结尾加入")])]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用SMTP认证")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_sasl_type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("dovecot")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_sasl_path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/var/spool/postfix/private/auth")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定postfix使用sasl验证：就是启用smtp并要求进行账号、密码效验")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_sasl_auth_enable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("yes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定SMTP认证的本地域名：可以使用''或注释掉，默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_sasl_local_domain")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("$myhostname")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 支持非标准验证规定的行为，")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定postfix兼容MUA使用不规则的smtp协议，主要针对老版本的outlook")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("broken_sasl_auth_clients")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("yes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当客户端引发错误时,postfix的初始等待时间 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_error_sleep_time")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("0s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 收件人限制条件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_recipient_restrictions")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("permit_mynetworks,permit_sasl_authenticated,reject_unauth_destination,reject_unknown_sender_domain")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 客户端限制")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_client_restrictions")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("permit_sasl_authenticated")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 取消smtp的匿名登录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("smtpd_sasl_security_options")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("noanonymous")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("proxy_read_maps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("$local_recipient_maps $mydestination $virtual_alias_maps $virtual_alias_domains $virtual_mailbox_maps $virtual_mailbox_domains $relay_recipient_maps $relay_domains $canonical_maps $sender_canonical_maps $recipient_canonical_maps $relocated_maps $transport_maps $mynetworks")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定通过postfix发送邮件的体积大小，此处表示5M")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("message_size_limit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5242880")]),t._v("\n")])])]),a("blockquote",[a("p",[a("code",[t._v("smtpd_recipient_restrictions")]),t._v("（收件人限制）有以下可用值：")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("permit_mynetworks")]),t._v("允许本地的网络接收")]),t._v(" "),a("p",[a("code",[t._v("permit_sasl_authenticated")]),t._v("允许通过"),a("code",[t._v("SASL")]),t._v("验证的用户（也就是"),a("code",[t._v("smtp")]),t._v("链接时通过了账号、密码效验的用户）的所有用户")]),t._v(" "),a("p",[a("code",[t._v("reject_unauth_destination")]),t._v("拒绝无法认证的目的地")])])]),t._v(" "),a("h3",{attrs:{id:"修改dovecot配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改dovecot配置"}},[t._v("#")]),t._v(" 修改Dovecot配置")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/dovecot/dovecot.conf\n")])])]),a("div",{staticClass:"language-conf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('auth_mechanisms = plain login\nbase_dir = /var/run/dovecot/\ndebug_log_path = /var/log/dovecot_debug.log\ndisable_plaintext_auth = no\nfirst_valid_uid = 1000\ninfo_log_path = /var/log/dovecot_info.log\nlogin_trusted_networks = 0.0.0.0/0\nmail_location = mbox:~/mail:INBOX=/var/mail/%u\nmbox_write_locks = fcntl\nnamespace inbox {\n  inbox = yes\n  location = mbox:~/mail:INBOX=/var/mail/%u\n  mailbox Drafts {\n    special_use = \\Drafts\n  }\n  mailbox Junk {\n    special_use = \\Junk\n  }\n  mailbox Sent {\n    special_use = \\Sent\n  }\n  mailbox "Sent Messages" {\n    special_use = \\Sent\n  }\n  mailbox Trash {\n    special_use = \\Trash\n  }\n  prefix =\n}\npassdb {\n  args = dovecot\n  driver = pam\n}\nservice auth {\n  unix_listener /var/spool/postfix/private/auth {\n    mode = 0666\n    user = postfix\n  }\n  unix_listener auth-userdb {\n    group = noreply\n    mode = 0666\n    user = noreply\n  }\n}\nservice imap-login {inet_listener imap {\n    port = 143\n  }\n}\nservice pop3-login {\n  inet_listener pop3 {\n    port = 110\n  }\n}\nssl = no\nssl_cert = </etc/pki/dovecot/certs/dovecot.pem\nssl_key = </etc/pki/dovecot/private/dovecot.pem\nuserdb {\n  driver = passwd\n}\n')])])]),a("ul",[a("li",[t._v("其实上面的配置文件并非一个，而是修改了"),a("code",[t._v("/etc/dovecot/conf.d")]),t._v("文件夹下的以下几个文件\n"),a("ul",[a("li",[a("code",[t._v("10-auth.conf")])]),t._v(" "),a("li",[a("code",[t._v("10-ssl.conf")])]),t._v(" "),a("li",[a("code",[t._v("10-mail.conf")])]),t._v(" "),a("li",[a("code",[t._v("10-master.conf")])]),t._v(" "),a("li",[a("code",[t._v("10-logging.conf")])])])])]),t._v(" "),a("blockquote",[a("p",[t._v("修改完成以后使用"),a("code",[t._v("doveconf -n > dovecot-new.conf")]),t._v("命令生成一个全新的综合的配置文件。")])]),t._v(" "),a("h3",{attrs:{id:"修改防火墙配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改防火墙配置"}},[t._v("#")]),t._v(" 修改防火墙配置")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("imap\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("smtp\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("pop3\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v("/udp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("110")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("110")]),t._v("/udp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("143")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("143")]),t._v("/udp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reload")]),t._v("\n")])])]),a("h3",{attrs:{id:"配置用户及权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置用户及权限"}},[t._v("#")]),t._v(" 配置用户及权限")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加用户")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useradd")]),t._v(" 用户名\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置密码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"密码"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("passwd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--stdin")]),t._v(" 用户名\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 授权")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" 0775 /var/spool/mail/*\n")])])]),a("h3",{attrs:{id:"启动服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[t._v("#")]),t._v(" 启动服务")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启postfix服务")]),t._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" postfix\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置postfix开机启动")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chkconfig")]),t._v(" postfix on\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启dovecot服务")]),t._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" dovecot\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置dovecot开机启动")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chkconfig")]),t._v(" dovecot on\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启postfix/dovecot")]),t._v("\nsystemctl restart postfix/dovecot\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看postfix/dovecot状态")]),t._v("\nsystemctl status postfix/dovecot\n")])])]),a("h3",{attrs:{id:"使用mail测试发信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用mail测试发信"}},[t._v("#")]),t._v(" 使用mail测试发信")]),t._v(" "),a("blockquote",[a("p",[t._v("未做明确配置时，"),a("code",[t._v("mail")]),t._v("默认将本机作为发信、收信的服务器，所以此步骤中的测试操作在邮件服务器本机完成。")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"邮件内容"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mail "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"邮件主题"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-r")]),t._v(" 发送人邮件地址 接收人邮件地址\n")])])]),a("h3",{attrs:{id:"使用telnet测试收信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用telnet测试收信"}},[t._v("#")]),t._v(" 使用telnet测试收信")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" telnet\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("telnet 域名 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v("\n")])])])])},[],!1,null,null,null);a.default=r.exports}}]);