(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{457:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"windowsvbscript"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#windowsvbscript"}},[t._v("#")]),t._v(" WindowsVBScript")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),s("li",[s("a",{attrs:{href:"#特殊符号"}},[t._v("特殊符号")])]),s("li",[s("a",{attrs:{href:"#函数封装"}},[t._v("函数封装")]),s("ul",[s("li",[s("a",{attrs:{href:"#自动关闭弹窗"}},[t._v("自动关闭弹窗")])]),s("li",[s("a",{attrs:{href:"#数组转换为字符串"}},[t._v("数组转换为字符串")])]),s("li",[s("a",{attrs:{href:"#获取对象的属性和值"}},[t._v("获取对象的属性和值")])]),s("li",[s("a",{attrs:{href:"#获取系统信息"}},[t._v("获取系统信息")])]),s("li",[s("a",{attrs:{href:"#隐藏窗口运行"}},[t._v("隐藏窗口运行")])]),s("li",[s("a",{attrs:{href:"#查看进程是否存在"}},[t._v("查看进程是否存在")])]),s("li",[s("a",{attrs:{href:"#ping"}},[t._v("Ping")])]),s("li",[s("a",{attrs:{href:"#监视网络连接"}},[t._v("监视网络连接")])]),s("li",[s("a",{attrs:{href:"#监视网络断开"}},[t._v("监视网络断开")])]),s("li",[s("a",{attrs:{href:"#设置壁纸"}},[t._v("设置壁纸")])]),s("li",[s("a",{attrs:{href:"#刷新桌面"}},[t._v("刷新桌面")])]),s("li",[s("a",{attrs:{href:"#字符编码转换"}},[t._v("字符编码转换")])]),s("li",[s("a",{attrs:{href:"#选择文件对话框"}},[t._v("选择文件对话框")])]),s("li",[s("a",{attrs:{href:"#文件编码转换"}},[t._v("文件编码转换")])])])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"flag"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/DoctorLai",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/DoctorLai"),s("OutboundLink")],1),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://isvbscriptdead.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://isvbscriptdead.com"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[t._v("批处理之家 "),s("a",{attrs:{href:"http://www.bathome.net",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.bathome.net"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("中国DOS联盟 "),s("a",{attrs:{href:"http://cndos.fam.cx/forum/forumdisplay.php?fid=23",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOS批处理 & 脚本技术（批处理室）"),s("OutboundLink")],1)])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//t0aew7h6(v=vs.85)",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/dotnet/visual-basic",target:"_blank",rel:"noopener noreferrer"}},[t._v("Visual Basic 指南"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//d1wf56tt%28v%3dvs.85%29",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript语言参考"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//0ad0dkea%28v%3dvs.85%29",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript基础知识"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.tcoline.com/resource/vbs/top_vbs_0.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript 语言"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://code.ziqiangxuetang.com/vbscript/vbscript-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript 教程"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.w3school.com.cn/vbscript/vbscript_ref_functions.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript 函数"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/MishaVernik/WScirpt",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/MishaVernik/WScirpt"),s("OutboundLink")],1)])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.runoob.com/vbscript/func-msgbox.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript MsgBox 函数"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"特殊符号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特殊符号"}},[t._v("#")]),t._v(" 特殊符号")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//hh277t8e%28v%3dvs.85%29",target:"_blank",rel:"noopener noreferrer"}},[t._v("String Constants"),s("OutboundLink")],1)])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("常数")]),t._v(" "),s("th",[t._v("值")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("vbCr")]),t._v(" "),s("td",[t._v("Chr(13)")]),t._v(" "),s("td",[t._v("回车符 "),s("code",[t._v("\\r")])])]),t._v(" "),s("tr",[s("td",[t._v("vbLf")]),t._v(" "),s("td",[t._v("Chr(10)")]),t._v(" "),s("td",[t._v("换行符 "),s("code",[t._v("\\n")])])]),t._v(" "),s("tr",[s("td",[t._v("vbCrLf")]),t._v(" "),s("td",[t._v("Chr(13)&Chr(10)")]),t._v(" "),s("td",[t._v("回车符与换行符 "),s("code",[t._v("\\r\\n")])])]),t._v(" "),s("tr",[s("td",[t._v("vbFormFeed")]),t._v(" "),s("td",[t._v("Chr(12)")]),t._v(" "),s("td",[t._v("换页符；在MicrosoftWindows中不适用。")])]),t._v(" "),s("tr",[s("td",[t._v("vbNewLine")]),t._v(" "),s("td",[t._v("Chr(13)&Chr(10)或Chr(10)")]),t._v(" "),s("td",[t._v("平台指定的新行字符；适用于任何平台。")])]),t._v(" "),s("tr",[s("td",[t._v("vbNullChar")]),t._v(" "),s("td",[t._v("Chr(0)")]),t._v(" "),s("td",[t._v("值为0的字符。")])]),t._v(" "),s("tr",[s("td",[t._v("vbNullString")]),t._v(" "),s("td",[t._v("值为0的字符串")]),t._v(" "),s("td",[t._v('与零长度字符串("")不同；用于调用外部过程。')])]),t._v(" "),s("tr",[s("td",[t._v("vbTab")]),t._v(" "),s("td",[t._v("Chr(9)")]),t._v(" "),s("td",[t._v("水平附签。")])]),t._v(" "),s("tr",[s("td",[t._v("vbVerticalTab")]),t._v(" "),s("td",[t._v("Chr(11)")]),t._v(" "),s("td",[t._v("垂直附签；在MicrosoftWindows中不用")])])])]),t._v(" "),s("h2",{attrs:{id:"函数封装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#函数封装"}},[t._v("#")]),t._v(" 函数封装")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/eklam/VbsJson",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/eklam/VbsJson"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/18216027/vbscript-script-progress-notification",target:"_blank",rel:"noopener noreferrer"}},[t._v("进度条"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/50514348/how-do-i-make-a-fake-progress-bar-in-vbscript",target:"_blank",rel:"noopener noreferrer"}},[t._v("进度条"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://wangye.org/blog/archives/767/",target:"_blank",rel:"noopener noreferrer"}},[t._v("WScript/VBScript实现ZIP文件的压缩或解压(ZipCompressor)"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" regex "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" RegExp\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" regex "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VBScript.RegExp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nregex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Global")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nregex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MultiLine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nregex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Pattern "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^\\s*\\n"')]),t._v("\nstr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" regex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"自动关闭弹窗"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动关闭弹窗"}},[t._v("#")]),t._v(" 自动关闭弹窗")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' TimeOut 单位为秒")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" MsgBoxTimeout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TimeOut"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WshShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    WshShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Popup Text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TimeOut"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Title\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),s("h3",{attrs:{id:"数组转换为字符串"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数组转换为字符串"}},[t._v("#")]),t._v(" 数组转换为字符串")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'数组转换为字符串")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Writer         Bajins")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create Date    2019-10-22")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'arrayName      数组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'separator      separator")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Example        ConvertArrayToString(array, ",")')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" ConvertArrayToString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("array"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" separator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" elementString\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" element "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" array\n        elementString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" elementString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Cstr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" separator\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\n    elementString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StrReverse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    elementString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Replace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" separator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    elementString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StrReverse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 设置返回值")]),t._v("\n    ConvertArrayToString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" elementString\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),s("h3",{attrs:{id:"获取对象的属性和值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取对象的属性和值"}},[t._v("#")]),t._v(" 获取对象的属性和值")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取对象的属性和值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Writer         Bajins")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create Date    2019-10-22")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'obj            对象")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Example        GetObjectPropertieValue(obj)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetObjectPropertieValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Exit Function")]),t._v("\n        Err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Raise Err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" kv\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" Propertie "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties_\n       kv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" kv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Propertie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" : "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Propertie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbCrLf\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    \n    kv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"属性数量："')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbCrLf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" kv\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 设置返回值")]),t._v("\n    GetObjectPropertieValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" kv\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),s("h3",{attrs:{id:"获取系统信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取系统信息"}},[t._v("#")]),t._v(" 获取系统信息")]),t._v(" "),s("blockquote",[s("p",[t._v("此方式完全不会显示"),s("code",[t._v("CMD")]),t._v("窗口（包括闪现）")])]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取系统位数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Writer         Bajins")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create Date    2019-10-22")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Example        GetSystemBit()")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetSystemBit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:{impersonationlevel=impersonate}!\\\\.\\root\\cimv2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ComputerSystem "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WMIService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstancesOf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Win32_ComputerSystem"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" System "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" ComputerSystem\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" InStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SystemType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"86"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            GetSystemBit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"i386"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" InStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SystemType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"64"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            GetSystemBit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"amd64"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objWMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts://./root/cimv2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'通过wmi获取激活状态的网络适配器对象后，读取IPAddress、Description、MACAddress")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" adapters "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objWMIService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Select * From Win32_NetworkAdapterConfiguration Where IPEnabled = True"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wshell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Wscript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Wscript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'直接从环境变量里取计算机名、当前用户名")]),t._v("\nresult "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HOSTNAME: 【"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" wshell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExpandEnvironmentStrings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%COMPUTERNAME%"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"】"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbcrlf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USER: 【"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" wshell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExpandEnvironmentStrings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%USERNAME%"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"】"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" adapter "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" adapters\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" adapter\n    result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbcrlf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbcrlf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Description "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v(" \n            vbcrlf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MAC:【"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MACAddress "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"】"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbcrlf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IP:【"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("  join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IPAddress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"】"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\nmsgbox result\n")])])]),s("h3",{attrs:{id:"隐藏窗口运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#隐藏窗口运行"}},[t._v("#")]),t._v(" 隐藏窗口运行")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 创建运行命令数组")]),t._v("\ncommands "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Array"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\frp内网穿透工具\\frpc.exe -c D:\\frp内网穿透工具\\frpc.ini"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 创建运行命令动态数组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Set commands = CreateObject("System.Collections.ArrayList")')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'commands.Add "D:\\frp内网穿透工具\\frpc.exe -c D:\\frp内网穿透工具\\frpc.ini"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 启动项键名称")]),t._v("\nkeyName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"frp"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WScript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" command "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" commands\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' cmd /c运行之后关闭窗口，0隐藏运行，false不同步运行")]),t._v("\n    shell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cmd /c "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 注册表项")]),t._v("\nitem "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 设置开机启动")]),t._v("\nshell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegWrite item "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" keyName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" WScript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScriptFullName\n")])])]),s("p",[s("strong",[t._v("Shell.Application")])]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[t._v("CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShellExecute "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo.exe"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c:/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),s("h3",{attrs:{id:"查看进程是否存在"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看进程是否存在"}},[t._v("#")]),t._v(" 查看进程是否存在")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[t._v("ProcesseName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rclone.exe"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 查找进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:{impersonationlevel=impersonate}!\\\\.\\root\\cimv2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Processes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WMIService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from win32_process where name=\'"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ProcesseName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\'"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" Process "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Processes\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 比较两个字符串")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" InStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UCase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UCase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProcesseName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 如果进程存在就不重复执行后面的代码")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 运行程序")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WS "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Wscript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Wscript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    WS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rclone mount GDrive:/ x: --cache-dir F:\\Temp --vfs-cache-mode writes"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n")])])]),s("h3",{attrs:{id:"ping"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ping"}},[t._v("#")]),t._v(" Ping")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" Ping"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strHostName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" colPingResults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" objPingResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" strQuery \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 定义WMI查询")]),t._v("\n  strQuery "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM Win32_PingStatus WHERE Address = \'"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" strHostName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\'"')]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 运行WMI查询")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' GetObject("winmgmts://./root/cimv2")')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colPingResults "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:root\\cimv2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 将查询结果转换为True或False")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" objPingResult "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" colPingResults \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("objPingResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n      Ping "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" objPingResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n        Ping "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v(" \n        Ping "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'WScript.Echo "Ping status code for " & strHostName & ": " & objPingResult.StatusCode ')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colPingResults "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),s("h3",{attrs:{id:"监视网络连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监视网络连接"}},[t._v("#")]),t._v(" 监视网络连接")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objWMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:\\\\.\\root\\wmi"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 执行事件订阅查询以接收事件。事件订阅查询定义了要监视的托管环境的更改。发生更改时，WMI基础结构会将事件描述为调用脚本。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colMonitoredEvents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objWMIService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecNotificationQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Select * from MSNdis_StatusMediaConnect"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Do")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("While")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" strLatestEvent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" colMonitoredEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NextEvent \n    Wscript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"已建立网络连接："')]),t._v("\n    WScript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo strLatestEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstanceName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Now\n    Wscript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Loop")]),t._v("\n")])])]),s("h3",{attrs:{id:"监视网络断开"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监视网络断开"}},[t._v("#")]),t._v(" 监视网络断开")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objWMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:\\\\.\\root\\wmi"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 执行事件订阅查询以接收事件。事件订阅查询定义了要监视的托管环境的更改。发生更改时，WMI基础结构会将事件描述为调用脚本。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colMonitoredEvents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objWMIService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecNotificationQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Select * from MSNdis_StatusMediaDisconnect"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Do")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("While")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" strLatestEvent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" colMonitoredEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NextEvent \n    Wscript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"网络连接已丢失："')]),t._v("\n    WScript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo strLatestEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstanceName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Now\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Loop")]),t._v("\n")])])]),s("h3",{attrs:{id:"设置壁纸"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置壁纸"}},[t._v("#")]),t._v(" 设置壁纸")]),t._v(" "),s("blockquote",[s("p",[t._v("使用API触发图片文件右键菜单上的 "),s("code",[t._v("设置为桌面背景(B)")])])]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shApp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" picFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Scripting.FileSystemObject"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Users\\bajin\\Desktop\\CachedImage_1920_1080_POS4.jpg"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取文件上的所有右键菜单项")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set items = shApp.NameSpace(picFile.ParentFolder.Path).ParseName(picFile.Name).Verbs()")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" items "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shApp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("NameSpace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("picFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ParentFolder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("picFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Verbs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 遍历所有菜单项")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' For i=0 To items.Count - 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set item = items.Item(i)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" item "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" items\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 注意执行的脚本文件需要为简体中文编码")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"设置为桌面背景(&B)"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' If strcomp(item.Name,"设置为桌面背景(&B)") = 0 Then')]),t._v("\n        item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DoIt\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n")])])]),s("h3",{attrs:{id:"刷新桌面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#刷新桌面"}},[t._v("#")]),t._v(" 刷新桌面")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 切换到桌面")]),t._v("\nCreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ToggleDesktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 刷新桌面")]),t._v("\nCreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SendKeys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{F5}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 切换到桌面")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'WSHShell.AppActivate("Program Manager")')]),t._v("\nWSHShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AppActivate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("WSHShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SpecialFolders"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Desktop"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 刷新桌面")]),t._v("\nWSHShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SendKeys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{F5}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 下面这两种方式没看出效果")]),t._v("\nCreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shell.application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("invokeVerb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"R&efresh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shell.application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("&H10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("invokeVerb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Refresh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 刷新桌面、任务栏、OSD（相当于重启资源管理器）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWSHShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"regsvr32.exe /s /n /i:/UserInstall %SystemRoot%\\system32\\themeui.dll"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 效果不太好，有时刷新成功，有时失败")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWSHShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RunDll32 USER32,UpdatePerUserSystemParameters"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' assoc文件关联时会自动刷新桌面，可能报错")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWSHShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"assoc .=."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 重启资源管理器并恢复打开的目录，暂时不可用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" RestartExplorer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" arrURL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shApp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 遍历所有打开的窗口")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" oWin "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" shApp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Windows\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 如果打开的窗口为资源管理器")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Instr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oWin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FullName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\explorer.exe"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbTextCompare"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ReDim")]),t._v(" Preserve arrURL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            arrURL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oWin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LocationURL\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'oWin.Document.folder.title")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 关闭当前打开的文件夹")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'oWin.quit")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 结束资源管理器进程")]),t._v("\n    CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"taskkill /f /im explorer.exe >nul 2>nul&start explorer.exe"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 遍历并打开之前的窗口")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" strURL "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" arrURL\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'shApp.Open strURL")]),t._v("\n        shApp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Explore strURL\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),s("h3",{attrs:{id:"字符编码转换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#字符编码转换"}},[t._v("#")]),t._v(" 字符编码转换")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 将UTF8编码文字转换为GB编码文字")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" UTF2GB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Dig"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'如果UTF8编码文字以%开头则进行转换")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Dig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'UTF8编码文字大于8则转换为汉字")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Dig"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n            GBStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ConvChinese"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            Dig"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Dig"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            GBStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        GBStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n    UTF2GB"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' UTF8编码文字将转换为汉字")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" ConvChinese"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     A"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n     j"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" ubound"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c16to2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" ubound"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      DigS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("instr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      Unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" j"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" DigS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" j"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n          A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("right"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DigS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          Unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Unicode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n           i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n           A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("right"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           Unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Unicode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c2to16"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unicode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n         ConvChinese"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ConvChinese "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" chrw"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&H"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" c2to16"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unicode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n         ConvChinese"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ConvChinese "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&H"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" c2to16"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unicode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'二进制代码转换为十六进制代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c2to16"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("step")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n            c2to16"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c2to16 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" hex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c2to10"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'二进制代码转换为十进制代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c2to10"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    c2to10"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n        i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" c2to10"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c2to10"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'十六进制代码转换为二进制代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c16to2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("trim"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        tempstr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c10to2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tempstr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n            tempstr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempstr\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("loop")]),t._v("\n        c16to2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c16to2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempstr\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'十进制代码转换为二进制代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c10to2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mysign"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sgn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("abs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    DigS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v("DigS "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            DigS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DigS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("loop")]),t._v("\n        tempnum"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("x\n\n        i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DigS "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("step")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" tempnum"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n            tempnum"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tempnum"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            c10to2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c10to2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            c10to2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c10to2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mysign"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" c10to2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" c10to2\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'GB转unicode---将GB编码文字转换为unicode编码文字")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" chinese2unicode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" i\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" Str_one\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" Str_unicode\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isnull"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_one"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Hex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ascw"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str_one"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("59")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n   chinese2unicode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("   \n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'URL解码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" URLDecode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" deStr\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("v\ndeStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    v"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" v"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enstr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enstr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        v"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        v"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cstr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("asc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        destr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("destr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("c\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("c\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\nURLDecode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'判断是否为有效的十六进制代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" c\n    isvalidhex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    str"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ucase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" left"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n    c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("or")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n    c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("or")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n")])])]),s("h3",{attrs:{id:"选择文件对话框"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选择文件对话框"}},[t._v("#")]),t._v(" 选择文件对话框")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SelectFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WshShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WScript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oExec "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WshShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"powershell -WindowStyle Hidden -ExecutionPolicy Bypass "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"[void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$dialog = New-Object 'System.Windows.Forms.OpenFileDialog';\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$dialog.Title ='请选择文件';\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$dialog.filter ='All|*.*|PowerShell|*.ps1';\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"if ($dialog.ShowDialog() -eq 'OK') {$dialog.FileName;} Else {Out-Null}\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    SelectFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oExec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdOut"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadAll\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SelectFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' GetStandardStream获取TextStream对象.参数：0输入流,1输出流,2错误流.")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' "new ActiveXObject(\'Scripting.FileSystemObject\').GetStandardStream(1).Write(f.value);" & _\n    hta="""about:<input type=file id=f><script>f.click();" & _\n        "new ActiveXObject(\'Scripting.FileSystemObject\').GetStandardStream(1).WriteLine(f.value);" & _\n        "close();resizeTo(0,0);<\/script>"""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 打开对话框")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oExec "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mshta.exe "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" hta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    StrLine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oExec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdOut"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadLine\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' StrLine = oExec.StdOut.ReadAll")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" StrLine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("And")]),t._v(" InStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("StrLine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Chr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' SelectFile = Left(StrLine, Pos - 1)")]),t._v("\n        SelectFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StrLine\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        SelectFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' sIniDir 为初始化目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' sFilter 为文件后缀 示例："*.*,*.txt"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFileDlgEx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIniDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sFilter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sTitle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sIniDir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Replace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIniDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\\\"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set regex = New RegExp")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" regex "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VBScript.RegExp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    regex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Global")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    regex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MultiLine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    regex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Pattern "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('";|\\|"')]),t._v("\n    sFilter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" regex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFilter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DIM")]),t._v(" sf\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFilter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        sf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    sFilter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sf\n    hta"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"""about:<object id=d classid=clsid:3050f4e1-98b5-11cf-bb82-00aa00bdce0b></object>"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<script>moveTo(0,-9999);"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"eval(new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(0)\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".Read("')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("Len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIniDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFilter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sTitle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"));"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function window.onload(){"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"var p=/[^\\0]*/;"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(1)\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".Write(p.exec(d.object.openfiledlg(iniDir,null,filter,title)));"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"close();"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}<\/script><hta:application showintaskbar=no />"""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oDlg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mshta.exe "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" hta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    oDlg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdIn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Write "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"var iniDir=\'"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sIniDir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"';var filter='\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sFilter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"';var title='\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sTitle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\';"')]),t._v(" \n    GetFileDlgEx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oDlg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdOut"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadAll \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" BrowseForFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" fso "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" fso "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Scripting.FileSystemObject"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" tempFolder "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" tempFolder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fso"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetSpecialFolder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" tempName "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tempName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fso"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetTempName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".hta"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HKCU\\Volatile Environment\\MsgResp"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" tempFolder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateTextFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tempName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Write "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<input type=file name=f>"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"<script>f.click();(new ActiveXObject('WScript.Shell'))\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".RegWrite('HKCU\\\\Volatile Environment\\\\MsgResp', f.value);\"")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"close();<\/script>"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run tempFolder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        BrowseForFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegRead"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegDelete path\n        fso"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeleteFile tempFolder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempName\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SelectFolder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objShell "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" IsNull"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set objFolder = objShell.Namespace(&H11) ' 获取当前计算机")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' default = objFolder.Self.Path")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' https://docs.microsoft.com/zh-cn/windows/win32/shell/shell-browseforfolder")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第一个参数：为对话框的窗体句柄，一般设置为0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第二个参数：为打开窗体的说明")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第三个参数：0/1/2/3/257/4097/8193/12289/16385/20481只从列表进行选择（列表内容不一样），")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'       529没有路径输入框，513没有路径输入框和新建文件夹按钮，&H10（17）有路径输入框，")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'       &H4000可看到文件但选择将报错;")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第四个参数：起始路径根文件夹，0/12/15/16为桌面，1/2/3/4/5/6/7/8/9/10/11/13/14/17/18/19/20/21/22")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Folder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BrowseForFolder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请选择一个文件夹:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("&H10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Folder "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n        SelectFolder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        SelectFolder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Path\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),s("h3",{attrs:{id:"文件编码转换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件编码转换"}},[t._v("#")]),t._v(" 文件编码转换")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.csdn.net/chuhe163/article/details/103549144",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBS处理UTF-8文本之ADODB.stream"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2.vbs"}},[t._v("文件编码转换.vbs")])])]),t._v(" "),s("p",[s("strong",[t._v("转换编码和换行符")])]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" read "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adodb.Stream"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("charset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),t._v("\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loadfromfile fdpath\ntext "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flush\nread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" save "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adodb.Stream"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("charset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GB2312"')]),t._v("\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WriteText replace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("vbLf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("vbCrLf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SaveToFile fdpath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flush\nsave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n")])])])])},[],!1,null,null,null);s.default=e.exports}}]);