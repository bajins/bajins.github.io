(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{350:function(a,t,s){"use strict";s.r(t);var e=s(2),r=Object(e.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"bat脚本使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bat脚本使用","aria-hidden":"true"}},[a._v("#")]),a._v(" bat脚本使用")]),a._v(" "),s("h2",{attrs:{id:"常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题","aria-hidden":"true"}},[a._v("#")]),a._v(" 常见问题")]),a._v(" "),s("blockquote",[s("p",[s("code",[a._v("if")]),a._v("和"),s("code",[a._v("for")]),a._v("的条件与后面跟的"),s("code",[a._v("(")]),a._v("之间必须要有一个空格，否则会出现"),s("code",[a._v("命令语法不正确")]),a._v("的问题！")]),a._v(" "),s("p",[a._v("使用cd切换目录时，如果带盘符一定要加"),s("code",[a._v("/d")]),a._v("参数，否则切换无效，例如："),s("code",[a._v("cd /d F:\\test")])])]),a._v(" "),s("h2",{attrs:{id:"获取管理员权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取管理员权限","aria-hidden":"true"}},[a._v("#")]),a._v(" 获取管理员权限")]),a._v(" "),s("h3",{attrs:{id:"方式一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式一","aria-hidden":"true"}},[a._v("#")]),a._v(" 方式一")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("cacls")]),a._v(".exe "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SystemDrive%\\System Volume Information"')]),a._v(" >nul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(">nul")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exist")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("del")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),s("h3",{attrs:{id:"方式二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式二","aria-hidden":"true"}},[a._v("#")]),a._v(" 方式二")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fltmc")]),a._v(">nul||cd"),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" ")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mshta")]),a._v(" vbscript:CreateObject("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Shell.Application"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".ShellExecute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"%~nx0","%1","","runas",1'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("window")]),a._v(".close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),s("h3",{attrs:{id:"方式三"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式三","aria-hidden":"true"}},[a._v("#")]),a._v(" 方式三")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 检查权限")]),a._v("\n>nul 2>"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SYSTEMROOT%\\system32\\cacls.exe"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%SYSTEMROOT%\\system32\\config\\system"')])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 如果没有管理员权限，就请求管理权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" '%"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("errorlevel")]),a._v("%' "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NEQ")]),a._v(" '"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" UACPrompt")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" gotAdmin ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":UACPrompt")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" Set UAC = CreateObject"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Shell.Application"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(") > "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" UAC.ShellExecute "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~s0"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"runas"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" >> "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')])]),a._v('\n    "%temp%\\getadmin.vbs"\n    '),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":gotAdmin")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exist")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("del")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%temp%\\getadmin.vbs"')]),a._v(" ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("pushd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%CD%"')])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CD")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/D")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0"')])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":begin")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),s("h3",{attrs:{id:"方式四"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式四","aria-hidden":"true"}},[a._v("#")]),a._v(" 方式四")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[a._v("%1 mshta vbscript:CreateObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"Shell.Application"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".ShellExecute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"cmd.exe","/c %~s0 ::","","runas",1'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("window")]),a._v(".close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0"')])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),s("h2",{attrs:{id:"隐藏窗口运行（静默运行）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#隐藏窗口运行（静默运行）","aria-hidden":"true"}},[a._v("#")]),a._v(" 隐藏窗口运行（静默运行）")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%1"')]),a._v(" == "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"h"')]),a._v(" goto begin")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mshta")]),a._v(" vbscript:createobject("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"wscript.shell"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"%~nx0 h",0'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("window")]),a._v(".close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":begin")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 下面为执行命令")]),a._v("\n\n")])])]),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 静默运行软件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Pushd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/wait")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0软件名称"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/S")])]),a._v("\n")])])]),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 添加开机静默启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Pushd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/wait")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0软件名称"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/ADD")])]),a._v("\n")])])]),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 删除开机静默启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Pushd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/wait")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/B")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%~dp0软件名称"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/DEL")])]),a._v("\n")])])]),s("h2",{attrs:{id:"注册表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册表","aria-hidden":"true"}},[a._v("#")]),a._v(" 注册表")]),a._v(" "),s("h3",{attrs:{id:"修改"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改","aria-hidden":"true"}},[a._v("#")]),a._v(" 修改")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 删除桌面IE图标")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" DELETE "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\{B416D21B-3B22-B6D4-BBD3-BBD452DB3D5B}"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 修改开机时小数字键盘不开启的问题")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REG")]),a._v(" ADD "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKU\\.DEFAULT\\Control Panel\\Keyboard"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" InitialKeyboardIndicators "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/t")]),a._v(" REG_SZ "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n\n")])])]),s("blockquote",[s("p",[s("code",[a._v("/v")]),a._v(" 设置键名(value)")]),a._v(" "),s("p",[s("code",[a._v("/t")]),a._v(" 设置数据类型(type)")]),a._v(" "),s("p",[s("code",[a._v("/d")]),a._v(" 设置添加的值(data)")]),a._v(" "),s("p",[s("code",[a._v("/f")]),a._v(" 表示强制(forbidden)")])]),a._v(" "),s("h3",{attrs:{id:"查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询","aria-hidden":"true"}},[a._v("#")]),a._v(" 查询")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("FOR /F "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"usebackq delims=="')]),a._v(" %i IN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("REG QUERY HKCU /v onedrive /s"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DO @echo %i\n")])])]),s("h2",{attrs:{id:"注册windows服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册windows服务","aria-hidden":"true"}},[a._v("#")]),a._v(" 注册Windows服务")]),a._v(" "),s("p",[a._v("https://www.cnblogs.com/pingming/p/5108947.html")]),a._v(" "),s("h3",{attrs:{id:"加入服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#加入服务","aria-hidden":"true"}},[a._v("#")]),a._v(" 加入服务:")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::等号后面的空格必须")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" create 服务名称 binPath= 路径 start= auto")]),a._v("\n")])])]),s("h3",{attrs:{id:"删除服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除服务","aria-hidden":"true"}},[a._v("#")]),a._v(" 删除服务:")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" delete 服务名称")]),a._v("\n")])])]),s("h3",{attrs:{id:"例一："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#例一：","aria-hidden":"true"}},[a._v("#")]),a._v(" 例一：")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" create frp内网穿透 binPath= D:\\frp\\frps.bat start= auto displayname= "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"frp内网穿透"')])]),a._v("\n")])])]),s("h3",{attrs:{id:"例二："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#例二：","aria-hidden":"true"}},[a._v("#")]),a._v(" 例二：")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sc")]),a._v(" create frp内网穿透 binPath= "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cmd.exe /c D:\\frp内网穿透工具\\frpc.exe -c D:\\frp内网穿透工具\\frpc.ini"')]),a._v(" start= auto displayname= "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"frp内网穿透"')])]),a._v("\n")])])]),s("h2",{attrs:{id:"添加快捷方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加快捷方式","aria-hidden":"true"}},[a._v("#")]),a._v(" 添加快捷方式")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: -------------------------------------------------------------------")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::                          添加开机静默启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::                     by https://www.bajins.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::                   GitHub https://woytu.github.io")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: -------------------------------------------------------------------")]),a._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("@")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" off")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%1"')]),a._v(" == "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"h"')]),a._v(" goto begin")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("mshta")]),a._v(" vbscript:createobject("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"wscript.shell"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v('"%~nx0 h",0'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("window")]),a._v(".close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":begin")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::设置快捷方式名称（必选）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: %~dp0 当前所在目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: %0 当前执行脚本路径")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("LnkName")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("测试.exe")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::设置快捷方式显示的说明（可选）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("Desc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("测试")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 设置快捷方式存放路径，DesKtop、Startup、AllUsersStartup、AllUsersDesktop")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("folder")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("DesKtop")]),a._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::设置程序或文件的完整路径（必选）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("Program")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0%")]),a._v("LnkName"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::设置程序的工作路径，一般为程序主目录，此项若留空，脚本将自行分析路径")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("WorkDir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("not")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("defined")]),a._v(" WorkDir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("call")]),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":GetWorkDir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%Program%"')])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::创建")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" Set WshShell=CreateObject("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"WScript.Shell"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(")")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" folder=WshShell.SpecialFolders("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%folder%"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(")")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" Set oShellLink=WshShell.CreateShortcut(folder"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v("&"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\%LnkName%.lnk"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(")")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" oShellLink.TargetPath="),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%Program%"')])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" oShellLink.WorkingDirectory="),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%WorkDir%"')])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" oShellLink.WindowStyle="),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" oShellLink.Description="),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%Desc%"')])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" oShellLink.Save")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" Msgbox("),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"快捷方式创建成功！"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" > makelnk.vbs\n\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("makelnk")]),a._v(".vbs")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("del")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/q")]),a._v(" makelnk.vbs")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exit")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":eof")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":GetWorkDir")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("WorkDir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp1")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("WorkDir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%WorkDir:~")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("-1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("goto")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token label property"}},[a._v(":eof")])]),a._v("\n")])])]),s("h2",{attrs:{id:"windows启动运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#windows启动运行","aria-hidden":"true"}},[a._v("#")]),a._v(" Windows启动运行")]),a._v(" "),s("h3",{attrs:{id:"增加注册表方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#增加注册表方式","aria-hidden":"true"}},[a._v("#")]),a._v(" 增加注册表方式")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("reg")]),a._v(" add "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" 软件名 "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" 软件路径 "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(':: 或者，%号和"号不能使用转移字符^转义，%号转义%%，"号转义"""')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("reg")]),a._v(" add "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" 软件名 "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("软件路径"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" /background"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")])]),a._v("\n")])])]),s("blockquote",[s("p",[a._v("按"),s("code",[a._v("win+r")]),a._v("打开运行窗口，输入以下命令"),s("code",[a._v("shell:startup")]),a._v("打开启动文件夹，把快捷方式放入")]),a._v(" "),s("p",[a._v("可利用"),s("a",{attrs:{href:"#%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F"}},[a._v("脚本添加快捷方式")]),a._v("直接在启动文件夹中生成快捷方式")])]),a._v(" "),s("h2",{attrs:{id:"命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令","aria-hidden":"true"}},[a._v("#")]),a._v(" 命令")]),a._v(" "),s("h3",{attrs:{id:"获取为指定后缀的文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取为指定后缀的文件","aria-hidden":"true"}},[a._v("#")]),a._v(" 获取为指定后缀的文件")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::获取为指定后缀的文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/r")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("*.jpg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("*.png"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t::把文件后缀赋值给变量\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" suffix "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~xa")])]),a._v("\n\t::把文件名赋值给变量（没有后缀）\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~na")])]),a._v("\n\t::把路径赋值给变量（不带驱动号和文件名）\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~pa")])]),a._v("\n\t::把驱动号赋值给变量\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" drive "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~da")])]),a._v("\n\t\n\t::判断后缀\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/i")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"!suffix!"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("neq")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('".bmp"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ren")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%%~a"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%%~na.bmp"')])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h3",{attrs:{id:"获取不为指定后缀的文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取不为指定后缀的文件","aria-hidden":"true"}},[a._v("#")]),a._v(" 获取不为指定后缀的文件")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("::获取不为指定后缀的文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"delims="')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%i")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),a._v("dir "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/s")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/b")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/a")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%~dp0")]),a._v(" ^| findstr "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\.bat\\> \\.text\\> \\.exe\\>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\t::把文件后缀写入文件\n\t"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("%%~dpnxi")]),a._v(" >> test.txt")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h3",{attrs:{id:"判断字符串是否包含子字符串"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#判断字符串是否包含子字符串","aria-hidden":"true"}},[a._v("#")]),a._v(" 判断字符串是否包含子字符串")]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 判断变量字符串中是否包含字符串")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" %字符串% | findstr %子串% >nul ")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 包含")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" || "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" 不包含")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h2",{attrs:{id:"第三方工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第三方工具","aria-hidden":"true"}},[a._v("#")]),a._v(" 第三方工具")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://eternallybored.org/misc/wget/",target:"_blank",rel:"noopener noreferrer"}},[a._v("wget-网络请求工具"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://curl.haxx.se/download.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("curl-网络请求工具"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://github.com/curl/curl",target:"_blank",rel:"noopener noreferrer"}},[a._v("curl-GitHub"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/stedolan/jq",target:"_blank",rel:"noopener noreferrer"}},[a._v("jq-解析json工具"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"http://www.bathome.net/thread-32322-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Batch-CN-在线第三方管理"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"http://bcn.bathome.net/s/tool/index.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("bcn"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"下载文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载文件","aria-hidden":"true"}},[a._v("#")]),a._v(" 下载文件")]),a._v(" "),s("h3",{attrs:{id:"bat执行js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bat执行js","aria-hidden":"true"}},[a._v("#")]),a._v(" "),s("router-link",{attrs:{to:"/Other/bat执行js.html#下载文件"}},[a._v("bat执行js")])],1),a._v(" "),s("h3",{attrs:{id:"certutil"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#certutil","aria-hidden":"true"}},[a._v("#")]),a._v(" certutil")]),a._v(" "),s("blockquote",[s("p",[a._v("用户备份证书服务管理，每次下载都会有缓存")]),a._v(" "),s("p",[a._v("缓存目录："),s("code",[a._v("%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content")])])]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("certutil")]),a._v(" -urlcache -split "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("-f")]),a._v(" https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\\Windows\\bcn.bat")]),a._v("\n")])])]),s("h3",{attrs:{id:"bitsadmin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bitsadmin","aria-hidden":"true"}},[a._v("#")]),a._v(" bitsadmin")]),a._v(" "),s("blockquote",[s("p",[a._v("bitsadmin.exe 可以用来在windows 命令行下下载文件。bitsadmin是windows 后台智能传输服务的一个工具，windows 的自动更新，补丁之类的下载就是用这个工具来实现的。")])]),a._v(" "),s("div",{staticClass:"language-batch extra-class"},[s("pre",{pre:!0,attrs:{class:"language-batch"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 无进度条等信息")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bitsadmin")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/rawreturn")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/transfer")]),a._v(" 任务名 https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\\Windows\\bcn.bat")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v(":: 有进度条等信息")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bitsadmin")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/transfer")]),a._v(" 任务名 "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/download")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[a._v("/priority")]),a._v(" normal https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\\Windows\\bcn.bat")]),a._v("\n")])])])])},[],!1,null,null,null);t.default=r.exports}}]);