(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{275:function(s,t,a){"use strict";a.r(t);var e=a(2),n=Object(e.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"mysql事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql事件","aria-hidden":"true"}},[s._v("#")]),s._v(" MySQL事件")]),s._v(" "),a("h2",{attrs:{id:"查看当前是否已开启事件调度器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看当前是否已开启事件调度器","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看当前是否已开启事件调度器")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" variables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'event_scheduler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"查看定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看定时任务","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看定时任务")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" information_schema"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("events"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"创建事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建事件","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建事件")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" EVENT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("IFNOT "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" event_name\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" SCHEDULE SCHEDULE\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" COMPLETION "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" PRESERVE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENABLE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'comment'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DO")]),s._v(" sql_statement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[a("span",{pre:!0,attrs:{class:"token inserted"}},[s._v("+[ON COMPLETION [NOT] PRESERVE] 可以设置这个事件是执行一次还是持久执行，默认为 NOT PRESERVE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[s._v("+[ENABLE | DISABLE] 可是设置该事件创建后状态是否开启或关闭，默认为ENABLE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[s._v("+[COMMENT 'comment'] 可以给该事件加上注释")]),s._v("\n")])])]),a("h2",{attrs:{id:"修改事件-alter-event"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改事件-alter-event","aria-hidden":"true"}},[s._v("#")]),s._v(" 修改事件(ALTER EVENT)")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" EVENT event_name\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" SCHEDULE SCHEDULE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RENAME")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" new_event_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" COMPLETION "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" PRESERVE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'comment'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENABLE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DO")]),s._v(" sql_statement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("h2",{attrs:{id:"删除事件-drop-event"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除事件-drop-event","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除事件(DROP EVENT)")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" EVENT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" event_name\n")])])]),a("h2",{attrs:{id:"开启任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开启任务","aria-hidden":"true"}},[s._v("#")]),s._v(" 开启任务")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" EVENT event_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"停止任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止任务","aria-hidden":"true"}},[s._v("#")]),s._v(" 停止任务")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" EVENT event_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"创建定时器，每间隔一秒调用一次存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建定时器，每间隔一秒调用一次存储过程","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建定时器，每间隔一秒调用一次存储过程")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELIMITER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" EVENT  event_remind_status  \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" SCHEDULE EVERY "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("second")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 调用存储过程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("call")]),s._v(" update_remind_status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELIMITER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n")])])]),a("h2",{attrs:{id:"每天凌晨1点执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#每天凌晨1点执行","aria-hidden":"true"}},[s._v("#")]),s._v(" 每天凌晨1点执行")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" EVENT "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),s._v(" temp_event   \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" SCHEDULE EVERY "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DAY")]),s._v(" STARTS DATE_ADD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DATE_ADD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CURDATE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTERVAL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DAY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTERVAL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("HOUR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" COMPLETION PRESERVE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENABLE")]),s._v("   \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DO")]),s._v(" 执行的"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v("语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"每隔一分钟执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#每隔一分钟执行","aria-hidden":"true"}},[s._v("#")]),s._v(" 每隔一分钟执行")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" event "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),s._v(" temp_event "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" SCHEDULE EVERY "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MINUTE")]),s._v("   \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" COMPLETION PRESERVE   \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DO")]),s._v(" 执行的"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v("语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"启动定时器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动定时器","aria-hidden":"true"}},[s._v("#")]),s._v(" 启动定时器")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" EVENT event_remind_status "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v("    \nCOMPLETION PRESERVE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n")])])])])},[],!1,null,null,null);t.default=n.exports}}]);