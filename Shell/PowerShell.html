<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell | Bajins</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/images/icons/logo.png">
    <link rel="apple-touch-icon" href="/images/icons/logo.png">
    <link rel="manifest" href="/manifest.json">
    <script type="text/javascript" src="/assets/js/load.js"></script>
    <meta name="description" content="PowerShell的命令叫做cmdlet(command-let), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，
&gt; 名词部分则描述了命令要操作的对象。例如，Get-Command就是指获取PowerShell中所有cmdlet命令。">
    <meta name="twitter:title" content="PowerShell">
    <meta name="twitter:description" content="PowerShell的命令叫做cmdlet(command-let), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，
&gt; 名词部分则描述了命令要操作的对象。例如，Get-Command就是指获取PowerShell中所有cmdlet命令。">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://bajins.com/Shell/PowerShell.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="PowerShell">
    <meta property="og:description" content="PowerShell的命令叫做cmdlet(command-let), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，
&gt; 名词部分则描述了命令要操作的对象。例如，Get-Command就是指获取PowerShell中所有cmdlet命令。">
    <meta property="og:url" content="https://bajins.com/Shell/PowerShell.html">
    <meta property="og:site_name" content="bajins">
    <meta itemprop="name" content="PowerShell">
    <meta itemprop="description" content="PowerShell的命令叫做cmdlet(command-let), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，
&gt; 名词部分则描述了命令要操作的对象。例如，Get-Command就是指获取PowerShell中所有cmdlet命令。">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/images/icons/logo.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="keywords" content="bajins,vue,vuepress,vuepress-theme,theme,主题,vuepress主题,blog
        ,vuepress-blog,java,python,shell,sql,golang,script,shell script,nginx,windows,去广告,androd,google drive
        ,one drive,idea,eclipse,git,小程序">
    <meta name="referrer" content="never">
    
    <link rel="preload" href="/assets/css/0.styles.921daf77.css" as="style"><link rel="preload" href="/assets/js/app.1faa001a.js" as="script"><link rel="preload" href="/assets/js/2.4296a15b.js" as="script"><link rel="preload" href="/assets/js/1.13868f42.js" as="script"><link rel="preload" href="/assets/js/94.c8672212.js" as="script"><link rel="prefetch" href="/assets/js/100.fb476d17.js"><link rel="prefetch" href="/assets/js/101.65373054.js"><link rel="prefetch" href="/assets/js/102.34afe950.js"><link rel="prefetch" href="/assets/js/103.08e76636.js"><link rel="prefetch" href="/assets/js/104.81b9f765.js"><link rel="prefetch" href="/assets/js/105.d87b9813.js"><link rel="prefetch" href="/assets/js/106.602c6293.js"><link rel="prefetch" href="/assets/js/107.9405c4cf.js"><link rel="prefetch" href="/assets/js/108.ded99788.js"><link rel="prefetch" href="/assets/js/109.ab499760.js"><link rel="prefetch" href="/assets/js/110.789e52aa.js"><link rel="prefetch" href="/assets/js/111.966ae33e.js"><link rel="prefetch" href="/assets/js/112.189d5eb3.js"><link rel="prefetch" href="/assets/js/113.8e20e93c.js"><link rel="prefetch" href="/assets/js/114.b70628d6.js"><link rel="prefetch" href="/assets/js/115.c82a373f.js"><link rel="prefetch" href="/assets/js/116.e34cd637.js"><link rel="prefetch" href="/assets/js/117.cc670f24.js"><link rel="prefetch" href="/assets/js/118.d958ab99.js"><link rel="prefetch" href="/assets/js/119.f5be99c9.js"><link rel="prefetch" href="/assets/js/12.a562b374.js"><link rel="prefetch" href="/assets/js/120.8675f97c.js"><link rel="prefetch" href="/assets/js/121.4cdd8db5.js"><link rel="prefetch" href="/assets/js/122.ca783f05.js"><link rel="prefetch" href="/assets/js/123.869d2c73.js"><link rel="prefetch" href="/assets/js/124.fd840642.js"><link rel="prefetch" href="/assets/js/125.74c9f0fa.js"><link rel="prefetch" href="/assets/js/126.3cd314db.js"><link rel="prefetch" href="/assets/js/127.457509ef.js"><link rel="prefetch" href="/assets/js/128.1b98a1c4.js"><link rel="prefetch" href="/assets/js/13.0df2e0a7.js"><link rel="prefetch" href="/assets/js/14.406f3fa2.js"><link rel="prefetch" href="/assets/js/15.71767727.js"><link rel="prefetch" href="/assets/js/16.c3b53708.js"><link rel="prefetch" href="/assets/js/17.37ca37ec.js"><link rel="prefetch" href="/assets/js/18.162669ae.js"><link rel="prefetch" href="/assets/js/19.091120bc.js"><link rel="prefetch" href="/assets/js/20.fb63d007.js"><link rel="prefetch" href="/assets/js/21.1c14567e.js"><link rel="prefetch" href="/assets/js/22.35d51bbe.js"><link rel="prefetch" href="/assets/js/23.825a1fb5.js"><link rel="prefetch" href="/assets/js/24.2e205b7a.js"><link rel="prefetch" href="/assets/js/25.e4fa03d6.js"><link rel="prefetch" href="/assets/js/26.85767710.js"><link rel="prefetch" href="/assets/js/27.d046a28b.js"><link rel="prefetch" href="/assets/js/28.6f83aea0.js"><link rel="prefetch" href="/assets/js/29.eedaa43e.js"><link rel="prefetch" href="/assets/js/3.00255157.js"><link rel="prefetch" href="/assets/js/30.8410e120.js"><link rel="prefetch" href="/assets/js/31.c7609f0f.js"><link rel="prefetch" href="/assets/js/32.5c322ef0.js"><link rel="prefetch" href="/assets/js/33.64cc9fe8.js"><link rel="prefetch" href="/assets/js/34.bcf6d63d.js"><link rel="prefetch" href="/assets/js/35.d726e14f.js"><link rel="prefetch" href="/assets/js/36.26402a9f.js"><link rel="prefetch" href="/assets/js/37.1e0403d6.js"><link rel="prefetch" href="/assets/js/38.2d75f668.js"><link rel="prefetch" href="/assets/js/39.4d8d888f.js"><link rel="prefetch" href="/assets/js/4.a41861e7.js"><link rel="prefetch" href="/assets/js/40.fb37b3d7.js"><link rel="prefetch" href="/assets/js/41.bb9946e4.js"><link rel="prefetch" href="/assets/js/42.cf5a059e.js"><link rel="prefetch" href="/assets/js/43.dc969823.js"><link rel="prefetch" href="/assets/js/44.fae0f835.js"><link rel="prefetch" href="/assets/js/45.c61a83fc.js"><link rel="prefetch" href="/assets/js/46.aaa58bd7.js"><link rel="prefetch" href="/assets/js/47.ce9952ea.js"><link rel="prefetch" href="/assets/js/48.27a679af.js"><link rel="prefetch" href="/assets/js/49.1d46de41.js"><link rel="prefetch" href="/assets/js/5.bbf8e470.js"><link rel="prefetch" href="/assets/js/50.abefa3e0.js"><link rel="prefetch" href="/assets/js/51.8b4021ed.js"><link rel="prefetch" href="/assets/js/52.023ec242.js"><link rel="prefetch" href="/assets/js/53.4ccae60e.js"><link rel="prefetch" href="/assets/js/54.48c46570.js"><link rel="prefetch" href="/assets/js/55.bcde0428.js"><link rel="prefetch" href="/assets/js/56.289a8f5a.js"><link rel="prefetch" href="/assets/js/57.dc4a711d.js"><link rel="prefetch" href="/assets/js/58.add3287e.js"><link rel="prefetch" href="/assets/js/59.baffa02b.js"><link rel="prefetch" href="/assets/js/6.c6438728.js"><link rel="prefetch" href="/assets/js/60.5992001b.js"><link rel="prefetch" href="/assets/js/61.fa8afda9.js"><link rel="prefetch" href="/assets/js/62.9fe383af.js"><link rel="prefetch" href="/assets/js/63.df19c15f.js"><link rel="prefetch" href="/assets/js/64.54698821.js"><link rel="prefetch" href="/assets/js/65.4c482019.js"><link rel="prefetch" href="/assets/js/66.6086e608.js"><link rel="prefetch" href="/assets/js/67.fbfb96e6.js"><link rel="prefetch" href="/assets/js/68.81007873.js"><link rel="prefetch" href="/assets/js/69.0199c159.js"><link rel="prefetch" href="/assets/js/7.afb14c62.js"><link rel="prefetch" href="/assets/js/70.2fcf8ce3.js"><link rel="prefetch" href="/assets/js/71.321b22a1.js"><link rel="prefetch" href="/assets/js/72.379b9ea7.js"><link rel="prefetch" href="/assets/js/73.4f1136ed.js"><link rel="prefetch" href="/assets/js/74.563df937.js"><link rel="prefetch" href="/assets/js/75.5d1ebb4f.js"><link rel="prefetch" href="/assets/js/76.fa2bb98d.js"><link rel="prefetch" href="/assets/js/77.92abe7f3.js"><link rel="prefetch" href="/assets/js/78.c2f60b8d.js"><link rel="prefetch" href="/assets/js/79.7a915e00.js"><link rel="prefetch" href="/assets/js/8.d99bad6b.js"><link rel="prefetch" href="/assets/js/80.81894c77.js"><link rel="prefetch" href="/assets/js/81.1e3e3ce3.js"><link rel="prefetch" href="/assets/js/82.d135f529.js"><link rel="prefetch" href="/assets/js/83.f8454a02.js"><link rel="prefetch" href="/assets/js/84.08db55e8.js"><link rel="prefetch" href="/assets/js/85.3bf464db.js"><link rel="prefetch" href="/assets/js/86.30271d76.js"><link rel="prefetch" href="/assets/js/87.efe1dc5a.js"><link rel="prefetch" href="/assets/js/88.849450cb.js"><link rel="prefetch" href="/assets/js/89.a3f2d9e4.js"><link rel="prefetch" href="/assets/js/90.cc19367e.js"><link rel="prefetch" href="/assets/js/91.359e1a28.js"><link rel="prefetch" href="/assets/js/92.9cef9392.js"><link rel="prefetch" href="/assets/js/93.92a0107b.js"><link rel="prefetch" href="/assets/js/95.9d596948.js"><link rel="prefetch" href="/assets/js/96.56d14cf1.js"><link rel="prefetch" href="/assets/js/97.ac9d011e.js"><link rel="prefetch" href="/assets/js/98.ccae6e29.js"><link rel="prefetch" href="/assets/js/99.dd37c751.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.37b7ea54.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.46952646.js">
    <link rel="stylesheet" href="/assets/css/0.styles.921daf77.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/icons/logo.png" alt="Bajins" class="logo"> <span class="site-name can-hide">Bajins</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/DBS/" class="nav-link">
  DBS
</a></div><div class="nav-item"><a href="/Go/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/IDE/" class="nav-link">
  IDE
</a></div><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/Other/" class="nav-link">
  Other
</a></div><div class="nav-item"><a href="/PL/" class="nav-link">
  PL
</a></div><div class="nav-item"><a href="/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/Shell/" class="nav-link router-link-active">
  Shell
</a></div><div class="nav-item"><a href="/System/" class="nav-link">
  System
</a></div><div class="nav-item"><a href="/Web/" class="nav-link">
  Web
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="快捷链接" class="dropdown-title"><span class="title">快捷链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="快捷链接" class="mobile-dropdown-title"><span class="title">快捷链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          外部链接
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tool.bajins.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  获取XShell
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tr.bajins.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OCR图片识别
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tool.bajins.com/wnf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  朋友圈不折叠
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://g.bajins.eu.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub反代
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://g.woetu.eu.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub反代
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tool.bajins.com/wp/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WeasyPrint
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tool.bajins.com/sd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Showdown
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          内部链接
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/files.html" class="nav-link">
  文件
</a></li><li class="dropdown-subitem"><a href="/Other/Bookmarks.html" class="nav-link">
  书签锦集
</a></li><li class="dropdown-subitem"><a href="/System/Windows软件.html" class="nav-link">
  Windows软件
</a></li><li class="dropdown-subitem"><a href="/Other/Markdown.html#工具" class="nav-link">
  Markdown工具
</a></li></ul></li></ul></div></div> <a href="https://github.com/bajins/notes-vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/DBS/" class="nav-link">
  DBS
</a></div><div class="nav-item"><a href="/Go/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/IDE/" class="nav-link">
  IDE
</a></div><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/Other/" class="nav-link">
  Other
</a></div><div class="nav-item"><a href="/PL/" class="nav-link">
  PL
</a></div><div class="nav-item"><a href="/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/Shell/" class="nav-link router-link-active">
  Shell
</a></div><div class="nav-item"><a href="/System/" class="nav-link">
  System
</a></div><div class="nav-item"><a href="/Web/" class="nav-link">
  Web
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="快捷链接" class="dropdown-title"><span class="title">快捷链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="快捷链接" class="mobile-dropdown-title"><span class="title">快捷链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          外部链接
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tool.bajins.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  获取XShell
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tr.bajins.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OCR图片识别
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tool.bajins.com/wnf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  朋友圈不折叠
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://g.bajins.eu.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub反代
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://g.woetu.eu.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub反代
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tool.bajins.com/wp/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WeasyPrint
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://tool.bajins.com/sd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Showdown
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          内部链接
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/files.html" class="nav-link">
  文件
</a></li><li class="dropdown-subitem"><a href="/Other/Bookmarks.html" class="nav-link">
  书签锦集
</a></li><li class="dropdown-subitem"><a href="/System/Windows软件.html" class="nav-link">
  Windows软件
</a></li><li class="dropdown-subitem"><a href="/Other/Markdown.html#工具" class="nav-link">
  Markdown工具
</a></li></ul></li></ul></div></div> <a href="https://github.com/bajins/notes-vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Shell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Shell/" aria-current="page" class="sidebar-link">Shell</a></li><li><a href="/Shell/PowerShell.html" aria-current="page" class="active sidebar-link">PowerShell</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#包管理" class="sidebar-link">包管理</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#在batch中嵌入运行" class="sidebar-link">在batch中嵌入运行</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#windows10自带应用" class="sidebar-link">Windows10自带应用</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#随机字符串" class="sidebar-link">随机字符串</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#http服务" class="sidebar-link">HTTP服务</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#弹窗" class="sidebar-link">弹窗</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#获取所有com组件" class="sidebar-link">获取所有COM组件</a></li><li class="sidebar-sub-header"><a href="/Shell/PowerShell.html#一行代码实现彩色树形-递归深度-2" class="sidebar-link">一行代码实现彩色树形（递归深度=2）</a></li></ul></li><li><a href="/Shell/PowerShell命令.html" class="sidebar-link">PowerShell命令</a></li><li><a href="/Shell/ShellScript.html" class="sidebar-link">ShellScript</a></li><li><a href="/Shell/ShellWindows.html" class="sidebar-link">ShellWindows</a></li><li><a href="/Shell/Shell命令.html" class="sidebar-link">Shell命令</a></li><li><a href="/Shell/WindowsBatch.html" class="sidebar-link">WindowsBatch</a></li><li><a href="/Shell/WindowsJScript.html" class="sidebar-link">WindowsJScript</a></li><li><a href="/Shell/WindowsScript.html" class="sidebar-link">WindowsScript</a></li><li><a href="/Shell/WindowsVBAScript.html" class="sidebar-link">VBAScript</a></li><li><a href="/Shell/WindowsVBScript.html" class="sidebar-link">WindowsVBScript</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="powershell"><a href="#powershell" class="header-anchor">#</a> PowerShell</h1> <p></p><div class="table-of-contents"><ul><li><a href="#flag">Flag</a></li><li><a href="#包管理">包管理</a></li><li><a href="#在batch中嵌入运行">在batch中嵌入运行</a></li><li><a href="#windows10自带应用">Windows10自带应用</a></li><li><a href="#随机字符串">随机字符串</a></li><li><a href="#http服务">HTTP服务</a></li><li><a href="#弹窗">弹窗</a></li><li><a href="#获取所有com组件">获取所有COM组件</a></li><li><a href="#一行代码实现彩色树形-递归深度-2">一行代码实现彩色树形（递归深度=2）</a></li></ul></div><p></p> <h2 id="flag"><a href="#flag" class="header-anchor">#</a> Flag</h2> <blockquote><p><code>PowerShell</code>的命令叫做<code>cmdlet</code>(<code>command-let</code>), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，
名词部分则描述了命令要操作的对象。例如，<code>Get-Command</code>就是指获取<code>PowerShell</code>中所有<code>cmdlet</code>命令。</p></blockquote> <blockquote><p><code>PowerShell</code>提供对<code>COM</code>（组件对象模型）和<code>WMI</code>（Windows管理规范）的完全访问，具有丰富的控制与自动化的系统管理能力，
能够轻松地做到实时、大规模的管理系统。获取本机所有<code>COM</code>组件对象脚本 <a href="/files/Get-COM-Objects.ps1">Get-COM-Objects.ps1</a></p></blockquote> <ul><li><a href="https://github.com/janikvonrotz/awesome-powershell" target="_blank" rel="noopener noreferrer">https://github.com/janikvonrotz/awesome-powershell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/PowerShell" target="_blank" rel="noopener noreferrer">https://github.com/PowerShell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ul><li><a href="https://www.zhihu.com/question/22611859/answers/updated" target="_blank" rel="noopener noreferrer">PowerShell 与 cmd 有什么不同？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ul><li><a href="https://docs.microsoft.com/zh-cn/powershell" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/powershell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/?view=powershell-7.1" target="_blank" rel="noopener noreferrer">PowerShell参考文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.pstips.net/why-is-powershell-powerful.html" target="_blank" rel="noopener noreferrer">PowerShell为什么强大<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.pstips.net/powershell-online-tutorials" target="_blank" rel="noopener noreferrer">PowerShell 在线教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/60797627" target="_blank" rel="noopener noreferrer">Powershell入门指南(一)·PowerShell及CLI发展<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/60798130" target="_blank" rel="noopener noreferrer">PowerShell入门指南(二)·挑战CMD和Bash的PowerShell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/76708298" target="_blank" rel="noopener noreferrer">PowerShell入门指南(三)·一门新的编程语言<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.pstips.net/speeding-up-powershell-multithreading.html" target="_blank" rel="noopener noreferrer">PowerShell提速和多线程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/MerLin-LiuNian/category/2027025.html" target="_blank" rel="noopener noreferrer">PowerShell - 随笔分类 - 门前有根大呲花 - 博客园<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>WMIC替代品 <a href="https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.management/get-wmiobject" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.management/get-wmiobject<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/get-ciminstance" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/get-ciminstance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://learn.microsoft.com/zh-cn/windows/win32/wmisdk" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/zh-cn/windows/win32/wmisdk<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://forsenergy.com" target="_blank" rel="noopener noreferrer">https://forsenergy.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.yiibai.com/powershell" target="_blank" rel="noopener noreferrer">https://www.yiibai.com/powershell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ul><li><a href="https://github.com/R3MRUM/PSDecode" target="_blank" rel="noopener noreferrer">https://github.com/R3MRUM/PSDecode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/rootclay/Powershell-Attack-Guide" target="_blank" rel="noopener noreferrer">https://github.com/rootclay/Powershell-Attack-Guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/rootclay/Windows-Access-Control" target="_blank" rel="noopener noreferrer">https://github.com/rootclay/Windows-Access-Control<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/setupfw/win-sf" target="_blank" rel="noopener noreferrer">https://github.com/setupfw/win-sf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="包管理"><a href="#包管理" class="header-anchor">#</a> 包管理</h2> <ul><li><a href="https://github.com/microsoft/winget-cli" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/winget-cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://github.com/microsoft/winget-pkgs" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/winget-pkgs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/windows/package-manager/winget<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/marticliment/WingetUI" target="_blank" rel="noopener noreferrer">https://github.com/marticliment/WingetUI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>winget upgrade <span class="token operator">--</span>all
winget source update <span class="token operator">--</span><span class="token function">clear-cache</span>
winget cache purge
</code></pre></div></li> <li><a href="https://github.com/oneget/oneget" target="_blank" rel="noopener noreferrer">https://github.com/oneget/oneget<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://www.nuget.org" target="_blank" rel="noopener noreferrer">https://www.nuget.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.powershellgallery.com" target="_blank" rel="noopener noreferrer">https://www.powershellgallery.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><a href="https://github.com/chocolatey" target="_blank" rel="noopener noreferrer">https://github.com/chocolatey<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://chocolatey.org" target="_blank" rel="noopener noreferrer">https://chocolatey.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><a href="https://github.com/lukesampson/scoop" target="_blank" rel="noopener noreferrer">https://github.com/lukesampson/scoop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://github.com/ScoopInstaller" target="_blank" rel="noopener noreferrer">https://github.com/ScoopInstaller<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/lukesampson/scoop-extras" target="_blank" rel="noopener noreferrer">https://github.com/lukesampson/scoop-extras<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/bjansen/scoop-apps" target="_blank" rel="noopener noreferrer">https://github.com/bjansen/scoop-apps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><a href="https://github.com/cmderdev/cmder" target="_blank" rel="noopener noreferrer">https://github.com/cmderdev/cmder<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/appget" target="_blank" rel="noopener noreferrer">https://github.com/appget<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="在batch中嵌入运行"><a href="#在batch中嵌入运行" class="header-anchor">#</a> 在batch中嵌入运行</h2> <ul><li><a href="https://blog.csdn.net/Captain_RB/article/details/111604033" target="_blank" rel="noopener noreferrer">PowerShell常用命令及使用方法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><p>由于Power Shell默认没有开启运行脚本策略，可以以此方式解决</p></blockquote> <blockquote><p>正则表达式排除以<code>@</code>和<code>:</code>开头的行，并将其他所有内容传递给Power Shell</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">findstr</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;^@.* ^:.*&quot;</span> <span class="token string">&quot;%~f0&quot;</span>|powershell -WindowStyle Hidden -ExecutionPolicy Bypass -</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">goto</span><span class="token label property">:eof</span></span>
&lt;# 从这里开始是 Power Shell代码 #&gt;
</code></pre></div><blockquote><p>这里巧妙的借用Power Shell的注释把bat脚本命令包裹，把整个脚本内容传入Power Shell并执行</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code>&lt;# ::
<span class="token operator">@</span><span class="token command"><span class="token keyword">powershell</span> -WindowStyle Hidden -ExecutionPolicy Bypass -&lt;<span class="token variable">%~f0</span> </span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">goto</span><span class="token label property">:eof</span></span>
#&gt;
# 保存到bat文件中可以双击执行，从这里开始是Power Shell代码
</code></pre></div><h2 id="windows10自带应用"><a href="#windows10自带应用" class="header-anchor">#</a> Windows10自带应用</h2> <blockquote><p>注意空格和英文标点</p></blockquote> <ul><li>查看已安装应用</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Get-AppxPackage</span> <span class="token punctuation">|</span> <span class="token function">Select</span> Name<span class="token punctuation">,</span>PackageFullName

<span class="token comment"># 查看Windows已装的自带应用</span>
<span class="token function">Get-AppxProvisionedPackage</span> <span class="token operator">-</span>online <span class="token punctuation">|</span> <span class="token operator">%</span> <span class="token punctuation">{</span>
    <span class="token comment"># 使用清单获取安装位置</span>
    <span class="token variable">$loc</span> = <span class="token function">Split-Path</span> <span class="token punctuation">(</span> <span class="token namespace">[Environment]</span>::ExpandEnvironmentVariables<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>InstallLocation<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">-</span>Parent
    <span class="token keyword">If</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Split-Path</span> <span class="token variable">$loc</span> <span class="token operator">-</span>Leaf<span class="token punctuation">)</span> <span class="token operator">-</span>ieq <span class="token string">'AppxMetadata'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$loc</span> = <span class="token function">Split-Path</span> <span class="token variable">$loc</span> <span class="token operator">-</span>Parent
    <span class="token punctuation">}</span>
    <span class="token comment"># 获取查找相关文件夹的模式</span>
    <span class="token variable">$matching</span> = <span class="token function">Join-Path</span> <span class="token operator">-</span>Path <span class="token punctuation">(</span><span class="token function">Split-Path</span> <span class="token variable">$loc</span> <span class="token operator">-</span>Parent<span class="token punctuation">)</span> <span class="token operator">-</span>ChildPath <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>DisplayName<span class="token punctuation">)</span></span>*&quot;</span>
    <span class="token variable">$size</span> = <span class="token string">&quot;{0:N2}MB&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token punctuation">(</span>
        <span class="token function">Get-ChildItem</span> <span class="token variable">$matching</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>ErrorAction Ignore <span class="token punctuation">|</span> <span class="token function">Measure-Object</span> <span class="token operator">-</span>Property Length <span class="token operator">-</span>Sum
        <span class="token punctuation">)</span><span class="token punctuation">.</span>Sum <span class="token operator">/</span> 1MB<span class="token punctuation">)</span>
    <span class="token comment"># 将结果添加到输出</span>
    <span class="token variable">$_</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>NotePropertyName Size <span class="token operator">-</span>NotePropertyValue <span class="token variable">$size</span>
    <span class="token variable">$_</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>NotePropertyName InstallFolder <span class="token operator">-</span>NotePropertyValue <span class="token variable">$loc</span>
    <span class="token variable">$_</span>
<span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Select</span> DisplayName<span class="token punctuation">,</span> PackageName<span class="token punctuation">,</span> Version<span class="token punctuation">,</span> InstallFolder<span class="token punctuation">,</span> Size
</code></pre></div><ul><li>卸载应用程序</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># 卸载所有账户中的应用</span>
<span class="token function">Get-AppxPackage</span> <span class="token operator">-</span>AllUsers <span class="token punctuation">|</span> <span class="token function">Remove-AppxPackage</span>
<span class="token comment"># 从系统账户中卸载应用</span>
<span class="token function">Get-AppXProvisionedPackage</span> <span class="token operator">-</span>online <span class="token punctuation">|</span> <span class="token function">Remove-AppxProvisionedPackage</span> –online
<span class="token comment"># 应用商店</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>store* <span class="token punctuation">|</span> <span class="token function">remove-Appxpackage</span>
<span class="token comment"># 日历、邮件</span>
<span class="token function">Get-AppxPackage</span> Microsoft<span class="token punctuation">.</span>windowscommunicationsapps <span class="token punctuation">|</span> <span class="token function">Remove-AppxPackage</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>communicationsapps* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 从系统账户中卸载日历、邮件应用</span>
<span class="token function">Get-AppXProvisionedPackage</span> –online <span class="token function">where-object</span> <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>packagename –like <span class="token string">&quot;*windowsmunicationsapps*&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">remove-appxprovisionedpackage</span> –online
<span class="token comment"># 人脉</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>people* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># Groove 音乐</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>zunemusic* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 电影和电视</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>zunevideo* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 财经</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>bingfinance* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 资讯</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>bingnews* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 体育</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>bingsports* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 天气</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>bingweather* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># OneNote</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>onenote* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 便笺 https://onenote.com/stickynotes</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>stickynotes* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># TODO https://to-do.microsoft.com</span>
<span class="token comment"># https://www.microsoft.com/zh-cn/microsoft-365/microsoft-to-do-list-app</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>todo* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 闹钟和时钟</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>alarms* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 计算器</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>calculator* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 相机</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>camera* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 照片</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>photos* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 地图</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>maps* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># 录音机</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>soundrecorder* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>
<span class="token comment"># XBox</span>
<span class="token function">get-appxpackage</span> <span class="token operator">*</span>xbox* <span class="token punctuation">|</span> <span class="token function">remove-appxpackage</span>

<span class="token comment"># OneDrive、GamePanel、WpcMon</span>
<span class="token comment"># 文件授予当前用户方式删除</span>
<span class="token variable">$path</span> = <span class="token string">&quot;C:\Windows\System32\OneDriveSetup.exe&quot;</span><span class="token punctuation">;</span> takeown <span class="token operator">/</span>f <span class="token variable">$path</span><span class="token punctuation">;</span> icacls <span class="token variable">$path</span> <span class="token operator">/</span>grant <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$env</span>:USERNAME<span class="token punctuation">)</span></span>:F&quot;</span><span class="token punctuation">;</span> <span class="token function">Remove-Item</span> <span class="token variable">$path</span> <span class="token operator">-</span>Force
<span class="token comment"># 权限提升方式删除</span>
<span class="token variable">$file</span> = <span class="token string">&quot;C:\Windows\System32\OneDriveSetup.exe&quot;</span><span class="token punctuation">;</span> <span class="token variable">$acl</span> = <span class="token function">Get-Acl</span> <span class="token variable">$file</span><span class="token punctuation">;</span> <span class="token variable">$rule</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>AccessControl<span class="token punctuation">.</span>FileSystemAccessRule<span class="token punctuation">(</span><span class="token string">&quot;BUILTIN\Administrators&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FullControl&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$acl</span><span class="token punctuation">.</span>SetAccessRule<span class="token punctuation">(</span><span class="token variable">$rule</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Set-Acl</span> <span class="token variable">$file</span> <span class="token variable">$acl</span><span class="token punctuation">;</span> <span class="token function">Remove-Item</span> <span class="token variable">$file</span> <span class="token operator">-</span>Force
</code></pre></div><ul><li>恢复应用程序</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># 应用商店</span>
<span class="token function">add-appxpackage</span> <span class="token operator">-</span>register <span class="token string">&quot;C:\Program Files\WindowsApps\*Store*\AppxManifest.xml&quot;</span> <span class="token operator">-</span>disabledevelopmentmode
<span class="token comment"># 计算器</span>
<span class="token function">Get-AppxPackage</span> <span class="token operator">*</span>calculator* <span class="token operator">-</span>AllUsers<span class="token punctuation">|</span> <span class="token keyword">Foreach</span> <span class="token punctuation">{</span>`
<span class="token function">Add-AppxPackage</span> <span class="token operator">-</span>DisableDevelopmentMode <span class="token operator">-</span>Register <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>InstallLocation<span class="token punctuation">)</span></span>\AppXManifest.xml&quot;</span><span class="token punctuation">}</span>
<span class="token comment"># 日历、邮件</span>
<span class="token function">Get-AppxPackage</span> Microsoft<span class="token punctuation">.</span>windowscommunicationsapps <span class="token operator">-</span>AllUsers<span class="token punctuation">|</span> <span class="token keyword">Foreach</span> <span class="token punctuation">{</span>`
<span class="token function">Add-AppxPackage</span> <span class="token operator">-</span>DisableDevelopmentMode <span class="token operator">-</span>Register <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>InstallLocation<span class="token punctuation">)</span></span>\AppXManifest.xml&quot;</span><span class="token punctuation">}</span>
</code></pre></div><ul><li>排除Windows Defender检查</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$exclusions</span>=@<span class="token punctuation">(</span><span class="token string">&quot;C:\Users\claer\Desktop\desktop-wallpaper-rust.exe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> `
<span class="token variable">$existingExclusions</span>=<span class="token namespace">[Collections.Generic.HashSet[String]]</span><span class="token punctuation">(</span><span class="token function">Get-MpPreference</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ExclusionProcess<span class="token punctuation">;</span> `
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$existingExclusions</span> <span class="token operator">-eq</span> <span class="token variable">$null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token variable">$existingExclusions</span> = <span class="token function">New-Object</span> Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">.</span>HashSet<span class="token namespace">[String]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> `
<span class="token variable">$exclusionsToAdd</span>=<span class="token namespace">[Linq.Enumerable]</span>::ToArray<span class="token punctuation">(</span><span class="token namespace">[Linq.Enumerable]</span>::Where<span class="token punctuation">(</span><span class="token variable">$exclusions</span><span class="token punctuation">,</span><span class="token namespace">[Func[object,bool]]</span><span class="token punctuation">{</span><span class="token keyword">param</span><span class="token punctuation">(</span><span class="token variable">$ex</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token variable">$existingExclusions</span><span class="token punctuation">.</span>Contains<span class="token punctuation">(</span><span class="token variable">$ex</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> `
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$exclusionsToAdd</span><span class="token punctuation">.</span>Length <span class="token operator">-gt</span> 0<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">Add-MpPreference</span> <span class="token operator">-</span>ExclusionProcess <span class="token variable">$exclusionsToAdd</span> <span class="token punctuation">}</span>
</code></pre></div><h2 id="随机字符串"><a href="#随机字符串" class="header-anchor">#</a> 随机字符串</h2> <blockquote><p><code>48..57</code>是数字0-9，powershell的范围操作符是<code>..</code>，<code>65..90</code>是大写字符A到Z，<code>97..122</code>是小写字母。
如果需要获取多有的可打印字符（包括空格）的话，范围是<code>32..127</code>。</p></blockquote> <blockquote><p><code>[char]</code>把对应数字转换成字符，例如 <code>[char](66)</code>就是B(大写字母B)，C语言使用的小括号来进行类型强制转换。</p></blockquote> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># 如果不指定-count参数，则前面的list有多少个字符</span>
<span class="token comment"># get-random就会获取多少个字符，只是顺序打乱了</span>
<span class="token operator">-join</span><span class="token punctuation">(</span><span class="token punctuation">(</span>48<span class="token punctuation">.</span><span class="token punctuation">.</span>57 <span class="token operator">+</span> 65<span class="token punctuation">.</span><span class="token punctuation">.</span>90 <span class="token operator">+</span> 97<span class="token punctuation">.</span><span class="token punctuation">.</span>122<span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">get-random</span> <span class="token operator">-</span>count 6 <span class="token punctuation">|</span> <span class="token operator">%</span><span class="token punctuation">{</span><span class="token namespace">[char]</span><span class="token variable">$_</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 输出19位数字字符串并在开头拼接x</span>
<span class="token punctuation">(</span>0<span class="token punctuation">.</span><span class="token punctuation">.</span>13<span class="token punctuation">|</span><span class="token function">Get-Random</span> <span class="token operator">-</span>count 19<span class="token punctuation">)</span> <span class="token operator">-join</span> <span class="token variable">$null</span> <span class="token punctuation">|</span> <span class="token operator">%</span><span class="token punctuation">{</span><span class="token operator">-join</span> <span class="token punctuation">(</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">,</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

<span class="token comment"># 这里的0..1024相当于循环控制，每循环一次|后面的代码执行一次，</span>
<span class="token comment"># 其中在数字字母中随机选一个字符 0..1024, like Perl, loop controller</span>
<span class="token operator">-join</span><span class="token punctuation">(</span>0<span class="token punctuation">.</span><span class="token punctuation">.</span>1024<span class="token punctuation">|</span><span class="token operator">%</span><span class="token punctuation">{</span><span class="token namespace">[char]</span><span class="token namespace">[int]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>48<span class="token punctuation">.</span><span class="token punctuation">.</span>57 <span class="token operator">+</span> 65<span class="token punctuation">.</span><span class="token punctuation">.</span>90 <span class="token operator">+</span> 97<span class="token punctuation">.</span><span class="token punctuation">.</span>122<span class="token punctuation">)</span><span class="token punctuation">|</span> <span class="token function">Get-Random</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">-join</span> <span class="token punctuation">(</span><span class="token namespace">[char[]]</span><span class="token punctuation">(</span>65<span class="token punctuation">.</span><span class="token punctuation">.</span>90+97<span class="token punctuation">.</span><span class="token punctuation">.</span>122<span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Get-Random</span> <span class="token operator">-</span>Count 6<span class="token punctuation">)</span>

<span class="token function">Add-Type</span> <span class="token operator">-</span>AssemblyName System<span class="token punctuation">.</span>Web<span class="token punctuation">;</span><span class="token namespace">[System.Web.Security.Membership]</span>::GeneratePassword<span class="token punctuation">(</span>20<span class="token punctuation">,</span> 0<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">Get-RandomString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token namespace">[int]</span><span class="token variable">$length</span>=10<span class="token punctuation">,</span>
    <span class="token comment"># 这里的[int]是类型指定</span>
    <span class="token namespace">[char[]]</span><span class="token variable">$sourcedata</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$loop</span>=1<span class="token punctuation">;</span> <span class="token variable">$loop</span> –le <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$loop</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$TempPassword</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token variable">$sourcedata</span> <span class="token punctuation">|</span> <span class="token function">GET-RANDOM</span> <span class="token punctuation">|</span> <span class="token operator">%</span><span class="token punctuation">{</span><span class="token namespace">[char]</span><span class="token variable">$_</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token variable">$TempPassword</span>
<span class="token punctuation">}</span>

<span class="token function">Get-RandomString</span> <span class="token operator">-</span>length 14 <span class="token operator">-</span>sourcedata <span class="token punctuation">(</span>48<span class="token punctuation">.</span><span class="token punctuation">.</span>127<span class="token punctuation">)</span>
</code></pre></div><h2 id="http服务"><a href="#http服务" class="header-anchor">#</a> HTTP服务</h2> <div class="language-ps1 extra-class"><pre class="language-text"><code>start-job { 
    $p=&quot;d:\&quot;
    #$p = Get-Location.path #获取当前用户的目录
    $H=New-Object Net.HttpListener
    $H.Prefixes.Add(&quot;http://+:8889/&quot;)
    $H.Start()
    While ($H.IsListening) {
        $HC=$H.GetContext()
        $HR=$HC.Response
        $HR.Headers.Add(&quot;Content-Type&quot;,&quot;text/plain&quot;)

        $file=Join-Path $p ($HC.Request).RawUrl
        $text=[IO.File]::ReadAllText($file)
        $text=[Text.Encoding]::UTF8.GetBytes($text)

        $HR.ContentLength64 = $text.Length
        $HR.OutputStream.Write($text,0,$text.Length)
        $HR.Close()
    }
    $H.Stop()
}
</code></pre></div><h2 id="弹窗"><a href="#弹窗" class="header-anchor">#</a> 弹窗</h2> <div class="language-ps1 extra-class"><pre class="language-text"><code>$xaml = @&quot;
&lt;Window xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation'&gt;
 &lt;Border BorderThickness='20' BorderBrush='Yellow' CornerRadius='9' Background='Red'&gt;
  &lt;StackPanel&gt;
   &lt;Label FontSize='50' FontFamily='Stencil' Background='Red' Foreground='White' BorderThickness='0'&gt;
    System will be rebooted in 15 minutes!
   &lt;/Label&gt;
   &lt;Label HorizontalAlignment='Center' FontSize='15' FontFamily='Consolas' Background='Red' Foreground='White' BorderThickness='0'&gt;
    Worried about losing data? Talk to your friendly help desk representative and freely share your concerns!
   &lt;/Label&gt;
  &lt;/StackPanel&gt;
 &lt;/Border&gt;
&lt;/Window&gt;
&quot;@;
Add-Type -assemblyName PresentationFramework;
$reader = [System.XML.XMLReader]::Create([System.IO.StringReader] $xaml);
$window = [System.Windows.Markup.XAMLReader]::Load($reader);
$Window.AllowsTransparency = $True;
$window.SizeToContent = 'WidthAndHeight';
$window.ResizeMode = 'NoResize';
$Window.Opacity = .7;
$window.Topmost = $true;
$window.WindowStartupLocation = 'CenterScreen';
$window.WindowStyle = 'None';
$null = $window.Show();
Start-Sleep -Seconds 10;
$window.Close();
</code></pre></div><p><strong>单行输入框</strong></p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># 首先，加载 System.Windows.Forms 程序集</span>
<span class="token function">Add-Type</span> <span class="token operator">-</span>AssemblyName System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms

<span class="token comment"># 创建输入框</span>
<span class="token variable">$InputBox</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Form
<span class="token variable">$InputBox</span><span class="token punctuation">.</span>StartPosition = <span class="token string">'CenterScreen'</span>
<span class="token variable">$InputBox</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>300<span class="token punctuation">,</span>200<span class="token punctuation">)</span>
<span class="token variable">$InputBox</span><span class="token punctuation">.</span>Topmost = <span class="token boolean">$True</span>

<span class="token comment"># 创建文本框并设置属性</span>
<span class="token variable">$TextBox</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TextBox
<span class="token variable">$TextBox</span><span class="token punctuation">.</span>Location = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point<span class="token punctuation">(</span>10<span class="token punctuation">,</span>10<span class="token punctuation">)</span>
<span class="token variable">$TextBox</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>260<span class="token punctuation">,</span>20<span class="token punctuation">)</span>
<span class="token variable">$InputBox</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token variable">$TextBox</span><span class="token punctuation">)</span>

<span class="token comment"># 创建确定按钮并设置属性</span>
<span class="token variable">$OKButton</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button
<span class="token variable">$OKButton</span><span class="token punctuation">.</span>Location = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point<span class="token punctuation">(</span>75<span class="token punctuation">,</span>50<span class="token punctuation">)</span>
<span class="token variable">$OKButton</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>75<span class="token punctuation">,</span>25<span class="token punctuation">)</span>
<span class="token variable">$OKButton</span><span class="token punctuation">.</span>Text = <span class="token string">&quot;OK&quot;</span>
<span class="token variable">$OKButton</span><span class="token punctuation">.</span>DialogResult = <span class="token namespace">[System.Windows.Forms.DialogResult]</span>::OK
<span class="token variable">$InputBox</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token variable">$OKButton</span><span class="token punctuation">)</span>
<span class="token variable">$InputBox</span><span class="token punctuation">.</span>AcceptButton = <span class="token variable">$OKButton</span>

<span class="token comment"># 显示输入框并等待用户操作</span>
<span class="token variable">$Show</span> = <span class="token variable">$InputBox</span><span class="token punctuation">.</span>ShowDialog<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 检查用户是否点击了确定按钮</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$Show</span> <span class="token operator">-eq</span> <span class="token namespace">[System.Windows.Forms.DialogResult]</span>::OK<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment"># 用户数据在这里</span>
    <span class="token variable">$UserInput</span> = <span class="token variable">$TextBox</span><span class="token punctuation">.</span>Text
    <span class="token variable">$InputBox</span><span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">Write-Host</span> <span class="token string">&quot;You entered: <span class="token variable">$UserInput</span>&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
    <span class="token variable">$InputBox</span><span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>多行输入框</strong></p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># 引入 System.Windows.Forms 组件</span>
<span class="token function">Add-Type</span> <span class="token operator">-</span>AssemblyName System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms

<span class="token comment"># 创建一个新的表单（窗体）</span>
<span class="token variable">$form</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Form
<span class="token variable">$form</span><span class="token punctuation">.</span>Text = <span class="token string">'Multi-line Input Box'</span>
<span class="token variable">$form</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>300<span class="token punctuation">,</span>200<span class="token punctuation">)</span>
<span class="token variable">$form</span><span class="token punctuation">.</span>StartPosition = <span class="token string">'CenterScreen'</span>

<span class="token comment"># 创建一个 Label，用来展示信息</span>
<span class="token variable">$label</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Label
<span class="token variable">$label</span><span class="token punctuation">.</span>Location = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point<span class="token punctuation">(</span>10<span class="token punctuation">,</span>10<span class="token punctuation">)</span>
<span class="token variable">$label</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>280<span class="token punctuation">,</span>20<span class="token punctuation">)</span>
<span class="token variable">$label</span><span class="token punctuation">.</span>Text = <span class="token string">'Please enter your text:'</span>
<span class="token variable">$form</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token variable">$label</span><span class="token punctuation">)</span>

<span class="token comment"># 创建一个 TextBox，用户可以在其中输入文字</span>
<span class="token variable">$textbox</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TextBox
<span class="token variable">$textbox</span><span class="token punctuation">.</span>Location = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point<span class="token punctuation">(</span>10<span class="token punctuation">,</span>40<span class="token punctuation">)</span>
<span class="token variable">$textbox</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>260<span class="token punctuation">,</span>100<span class="token punctuation">)</span>
<span class="token variable">$textbox</span><span class="token punctuation">.</span>AcceptsReturn = <span class="token boolean">$true</span>
<span class="token variable">$textbox</span><span class="token punctuation">.</span>Multiline = <span class="token boolean">$true</span>
<span class="token variable">$form</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token variable">$textbox</span><span class="token punctuation">)</span>

<span class="token comment"># 创建一个 OK 按钮来提交输入内容</span>
<span class="token variable">$okButton</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button
<span class="token variable">$okButton</span><span class="token punctuation">.</span>Location = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point<span class="token punctuation">(</span>10<span class="token punctuation">,</span>150<span class="token punctuation">)</span>
<span class="token variable">$okButton</span><span class="token punctuation">.</span>Size = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size<span class="token punctuation">(</span>75<span class="token punctuation">,</span>23<span class="token punctuation">)</span>
<span class="token variable">$okButton</span><span class="token punctuation">.</span>Text = <span class="token string">'OK'</span>
<span class="token variable">$okButton</span><span class="token punctuation">.</span>DialogResult = <span class="token namespace">[System.Windows.Forms.DialogResult]</span>::OK
<span class="token variable">$form</span><span class="token punctuation">.</span>AcceptButton = <span class="token variable">$okButton</span>
<span class="token variable">$form</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token variable">$okButton</span><span class="token punctuation">)</span>

<span class="token comment"># 展示表单</span>
<span class="token variable">$form</span><span class="token punctuation">.</span>Topmost = <span class="token boolean">$true</span>
<span class="token variable">$result</span> = <span class="token variable">$form</span><span class="token punctuation">.</span>ShowDialog<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 按下 OK 按钮后获取 TextBox 中的内容</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">-eq</span> <span class="token namespace">[System.Windows.Forms.DialogResult]</span>::OK<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$input</span> = <span class="token variable">$textbox</span><span class="token punctuation">.</span>Text
    <span class="token variable">$form</span><span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">Write-Host</span> <span class="token string">&quot;You entered: <span class="token variable">$input</span>&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="获取所有com组件"><a href="#获取所有com组件" class="header-anchor">#</a> 获取所有COM组件</h2> <div class="language-ps1 extra-class"><pre class="language-text"><code>gci HKLM:\Software\Classes -ea 0| ? {$_.PSChildName -match '^\w+\.\w+$' -and (gp &quot;$($_.PSPath)\CLSID&quot; -ea 0)} | ft PSChildName
</code></pre></div><h2 id="一行代码实现彩色树形-递归深度-2"><a href="#一行代码实现彩色树形-递归深度-2" class="header-anchor">#</a> 一行代码实现彩色树形（递归深度=2）</h2> <p>Get-ChildItem . -Recurse -Depth 2 |
ForEach-Object {
$prefix = &quot;│  &quot; * ($<em>.FullName.Split('').Count - ($PWD.Path.Split('').Count + 1))
if ($</em>.PSIsContainer) {
Write-Host &quot;${prefix}├── $($<em>.Name)&quot; -ForegroundColor Cyan
} else {
Write-Host &quot;${prefix}├── $($</em>.Name)&quot; -ForegroundColor Green
}
}</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/bajins/notes-vuepress/edit/master//Shell/PowerShell.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2026-02-28 02:28:37</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Shell/" class="prev router-link-active">
        Shell
      </a></span> <span class="next"><a href="/Shell/PowerShell命令.html">
        PowerShell命令
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1faa001a.js" defer></script><script src="/assets/js/2.4296a15b.js" defer></script><script src="/assets/js/1.13868f42.js" defer></script><script src="/assets/js/94.c8672212.js" defer></script>
  </body>
</html>
